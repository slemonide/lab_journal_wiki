<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach/Overview of relevant fields - Lab Journal Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields","wgTitle":"Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach/Overview of relevant fields","wgCurRevisionId":604,"wgRevisionId":604,"wgArticleId":26,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Mesoscale ocean eddies"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May",
"Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields","wgRelevantArticleId":26,"wgRequestId":"c3bfcd5346266621769bde1e","wgCSPNonce":!1,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Motivation/1","wgMediaViewerOnClick":!0,"wgMediaViewerEnabledByDefault":!0,"wgInternalRedirectTargetUrl":"/index.php?title=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields\u0026printable=yes"};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","ext.pygments":"ready",
"mediawiki.page.gallery.styles":"ready","ext.cite.styles":"ready","ext.math.styles":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","jquery.makeCollapsible.styles":"ready","mediawiki.toc.styles":"ready","ext.scite.styles":"ready","ext.smw.style":"ready","ext.smw.tooltip.styles":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"};RLPAGEMODULES=["mediawiki.action.view.redirect","ext.smw.style","ext.smw.tooltips","mediawiki.page.gallery","ext.cite.ux-enhancements","ext.math.scripts","ext.smw.table.styles","smw.factbox","site","mediawiki.page.startup","mediawiki.page.ready","jquery.makeCollapsible","mediawiki.toc","mediawiki.searchSuggest","ext.scite.styles","ext.scite.tooltip","mmv.head","mmv.bootstrap.autostart","skins.vector.js"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.tokens@tffin",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="load.php%3Flang=en&amp;modules=ext.cite.styles|ext.math.styles|ext.pygments|jquery.makeCollapsible.styles|mediawiki.legacy.commonPrint,shared|mediawiki.page.gallery.styles|mediawiki.skinning.interface|mediawiki.toc.styles|skins..css"/>
<link rel="stylesheet" href="load.php%3Flang=en&amp;modules=ext.scite.styles|ext.smw.style|ext.smw.tooltip.styles&amp;only=styles&amp;printable=1&amp;skin=vector.css"/>
<script async="" src="load.php%3Flang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.34.2"/>
<meta name="robots" content="noindex,follow"/>
<link rel="alternate" type="application/rdf+xml" title="Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach/Overview of relevant fields" href="./index.php%3Ftitle=Special:ExportRDF%252FResearch:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;xmlmime=rdf"/>
<link rel="shortcut icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Lab Journal Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php%3Faction=rsd"/>
<link rel="canonical" href="wiki/Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields.html"/>
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Research_Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach_Overview_of_relevant_fields rootpage-Research_Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach skin-vector action-view">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach/Overview of relevant fields</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From Lab Journal Wiki</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="wiki/Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach.html" title="Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach">Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach</a></span><span class="mw-redirectedfrom">(Redirected from <a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;redirect=no.html" class="mw-redirect" title="Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach/Motivation/1">Research:Evaluating deformation-based paramatrization of ocean mesoscale eddies using eddy geometry approach/Motivation/1</a>)</span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>Let's make some plots.
</p>
<div id="toc" class="toc"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Streamfunction"><span class="tocnumber">1</span> <span class="toctext">Streamfunction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Streamfunction_statistics"><span class="tocnumber">1.1</span> <span class="toctext">Streamfunction statistics</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Higher_moments_statistics"><span class="tocnumber">1.2</span> <span class="toctext">Higher moments statistics</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Eddy_Anisotropy"><span class="tocnumber">2</span> <span class="toctext">Eddy Anisotropy</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Time_mean_eddy_anisotropy"><span class="tocnumber">2.1</span> <span class="toctext">Time mean eddy anisotropy</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Spatial_mean_eddy_anisotropy"><span class="tocnumber">2.2</span> <span class="toctext">Spatial mean eddy anisotropy</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Product_of_large-scale_deformation_and_vorticity"><span class="tocnumber">3</span> <span class="toctext">Product of large-scale deformation and vorticity</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Time_mean"><span class="tocnumber">3.1</span> <span class="toctext">Time mean</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Spatial_mean"><span class="tocnumber">3.2</span> <span class="toctext">Spatial mean</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Comparing_eddy_anisotropy_to_deformation_and_vorticity_product"><span class="tocnumber">4</span> <span class="toctext">Comparing eddy anisotropy to deformation and vorticity product</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Comparing_at_a_point"><span class="tocnumber">4.1</span> <span class="toctext">Comparing at a point</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#Local_patch"><span class="tocnumber">4.2</span> <span class="toctext">Local patch</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#TODO"><span class="tocnumber">5</span> <span class="toctext">TODO</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Streamfunction">Streamfunction</span></h2>
<h3><span class="mw-headline" id="Streamfunction_statistics">Streamfunction statistics</span></h3>
<p>First, let's compute the time mean and standard deviation of the streamfunction:
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute streamfunction statistics
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

<span class="c1"># compute mean psi field</span>
psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/1.Rds&quot;</span><span class="p">)</span>
psi_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
psi_sq_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span> <span class="p">{</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/@{i}.Rds&quot;</span><span class="p">))</span>
  psi_mean <span class="o">&lt;-</span> psi_mean <span class="o">+</span> psi
  psi_sq_mean <span class="o">&lt;-</span> psi_sq_mean <span class="o">+</span> psi<span class="o">^</span><span class="m">2</span>
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>
psi_mean <span class="o">&lt;-</span> psi_mean <span class="o">/</span> <span class="m">1000</span>
psi_sq_mean <span class="o">&lt;-</span> psi_sq_mean <span class="o">/</span> <span class="m">1000</span>

psi_std <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>psi_sq_mean <span class="o">-</span> psi_mean<span class="o">^</span><span class="m">2</span> <span class="o">+</span> <span class="m">3e-14</span><span class="p">)</span> <span class="c1"># need 3e-14 because of numerical errors?</span>

<span class="c1"># save for later usage</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/psi_mean.Rds&quot;</span><span class="p">)</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_sq_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/psi_sq_mean.Rds&quot;</span><span class="p">)</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_std<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/psi_std.Rds&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot streamfunction statistics
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># load data</span>
psi_mean <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_stat_model_data/psi_mean.Rds&quot;</span><span class="p">)</span>
psi_sq_mean <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_stat_model_data/psi_sq_mean.Rds&quot;</span><span class="p">)</span>
psi_std <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_stat_model_data/psi_std.Rds&quot;</span><span class="p">)</span>

<span class="c1"># plot</span>
png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;streamfunction_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
imagep<span class="p">(</span>psi_mean<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Steamfunction (mean)&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;streamfunction_std.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
imagep<span class="p">(</span>psi_std<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Steamfunction (std)&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;streamfunction_meridional_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">-400</span><span class="o">:</span><span class="m">400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">colMeans</span><span class="p">(</span>psi_mean<span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged meridional streamfunction (mean)&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;streamfunction_zonal_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">rowMeans</span><span class="p">(</span>psi_mean<span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged zonal streamfunction (mean)&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;streamfunction_meridional_std.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">-400</span><span class="o">:</span><span class="m">400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">colMeans</span><span class="p">(</span>psi_std<span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged meridional streamfunction (std)&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;streamfunction_zonal_std.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">rowMeans</span><span class="p">(</span>psi_std<span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged zonal streamfunction (std)&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

<span class="c1"># TODO:</span>
<span class="c1"># image(psi_std &gt; 0.03)</span>
<span class="c1"># imagep(psi_std,zlim=c(0,0.03),decimate=FALSE)</span>
<span class="c1"># hist(psi_std)</span>
<span class="c1"># hist(psi_std, xlim=c(0.0031,0.3))</span>
<span class="c1"># ROUGHLY: there are three regions: 0 to 0.03, 0.03 to 0.3, and 0.3 to 0.6.</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_streamfunction_mean.png.html" class="image"><img alt="" src="images/thumb/6/6e/Eddy_geometry_deformation_streamfunction_mean.png/360px-Eddy_geometry_deformation_streamfunction_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/6/6e/Eddy_geometry_deformation_streamfunction_mean.png/540px-Eddy_geometry_deformation_streamfunction_mean.png 1.5x, images/thumb/6/6e/Eddy_geometry_deformation_streamfunction_mean.png/720px-Eddy_geometry_deformation_streamfunction_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_streamfunction_std.png.html" class="image"><img alt="" src="images/thumb/e/e3/Eddy_geometry_deformation_streamfunction_std.png/360px-Eddy_geometry_deformation_streamfunction_std.png" decoding="async" width="240" height="120" srcset="images/thumb/e/e3/Eddy_geometry_deformation_streamfunction_std.png/540px-Eddy_geometry_deformation_streamfunction_std.png 1.5x, images/thumb/e/e3/Eddy_geometry_deformation_streamfunction_std.png/720px-Eddy_geometry_deformation_streamfunction_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>STD
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_streamfunction_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/2/22/Eddy_geometry_deformation_streamfunction_meridional_mean.png/360px-Eddy_geometry_deformation_streamfunction_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/2/22/Eddy_geometry_deformation_streamfunction_meridional_mean.png/540px-Eddy_geometry_deformation_streamfunction_meridional_mean.png 1.5x, images/thumb/2/22/Eddy_geometry_deformation_streamfunction_meridional_mean.png/720px-Eddy_geometry_deformation_streamfunction_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_streamfunction_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/7/7e/Eddy_geometry_deformation_streamfunction_zonal_mean.png/360px-Eddy_geometry_deformation_streamfunction_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/7/7e/Eddy_geometry_deformation_streamfunction_zonal_mean.png/540px-Eddy_geometry_deformation_streamfunction_zonal_mean.png 1.5x, images/thumb/7/7e/Eddy_geometry_deformation_streamfunction_zonal_mean.png/720px-Eddy_geometry_deformation_streamfunction_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_streamfunction_meridional_std.png.html" class="image"><img alt="" src="images/thumb/d/d1/Eddy_geometry_deformation_streamfunction_meridional_std.png/360px-Eddy_geometry_deformation_streamfunction_meridional_std.png" decoding="async" width="240" height="120" srcset="images/thumb/d/d1/Eddy_geometry_deformation_streamfunction_meridional_std.png/540px-Eddy_geometry_deformation_streamfunction_meridional_std.png 1.5x, images/thumb/d/d1/Eddy_geometry_deformation_streamfunction_meridional_std.png/720px-Eddy_geometry_deformation_streamfunction_meridional_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional STD
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_streamfunction_zonal_std.png.html" class="image"><img alt="" src="images/thumb/5/57/Eddy_geometry_deformation_streamfunction_zonal_std.png/360px-Eddy_geometry_deformation_streamfunction_zonal_std.png" decoding="async" width="240" height="120" srcset="images/thumb/5/57/Eddy_geometry_deformation_streamfunction_zonal_std.png/540px-Eddy_geometry_deformation_streamfunction_zonal_std.png 1.5x, images/thumb/5/57/Eddy_geometry_deformation_streamfunction_zonal_std.png/720px-Eddy_geometry_deformation_streamfunction_zonal_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal STD
</p>
			</div>
		</div></li>
</ul>
<p>As you might notice, streamfunction statistics captures quite a lot of the jet structure. For example, we right away see that there are three regions:
</p>
<ul><li>Unstable jet: x from 0 to 30</li>
<li>Transition: x from 30 to 40</li>
<li>Wave maker: x from 40 to 60</li></ul>
<p>This agrees with<sup id="cite_ref-1" class="reference"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#cite_note-1">&#91;1&#93;</a></sup>. Furthermore, most of the jet variance is centered in the middle meridionally, signaling the location of turbulent zone. It would be interesting to compare this statistics with other fields.
</p><p>Also zonal mean likely tells us something about the direction of the flow: roughly below x=15, there are large recirculation gyres which dominate the flow and force it to go backward. On the other hand, right above x=15, these gyres stabilize a jet that forces the flow to go forward. In a sense, this is just conservation of momentum.
</p>
<div style="background-color: antiquewhite; border-style: solid; margin: 10px; padding: 10px; display:inline-block">
<p><b>Note</b>: For the task at hand, there are two important regions: region dominated by downgradient eddy fluxes and a region dominated by upgradient eddy fluxes. Also, region with largest streamfunction variance is interesting.
</p>
</div>
<h3><span class="mw-headline" id="Higher_moments_statistics">Higher moments statistics</span></h3>
<p>If we want to, we could also analyze higher order statistics. For example, <a href="https://en.wikipedia.org/wiki/Skewness" class="extiw" title="wikipedia:Skewness">skewness</a> and <a href="https://en.wikipedia.org/wiki/Kurtosis" class="extiw" title="wikipedia:Kurtosis">kurtosis</a>. Roughly, we get higher moments by computing <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbb {E} X^{n}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="double-struck">E</mi>
        </mrow>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbb {E} X^{n}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3ee27bbcbbc76219effbe1c2b069c2fe640a6d89" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:4.766ex; height:2.343ex;" alt="{\displaystyle \mathbb {E} X^{n}}"/></span>. For n=1, this is mean, for n=2, this is std, for n=3, this is skewness, for n=4, this is kurtosis, and so on.
</p><p>If our distribution is Gaussian, then we should expect all moments larger than 2 to be zero. That is, Gaussian distribution can be completely described just by the mean and standard deviation. It might be interesting to look at the spatial distribution of higher moments as it will also tell if we actually have enough data to properly estimate standard deviation and mean.
</p><p>Here is the code to compute higher moments:
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute higher moments statistics of the streamfunction
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span> <span class="c1"># load qq(&quot;@{i}&quot;) syntax</span>

<span class="c1"># compute mean psi field</span>
psi_mean <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_stat_model_data/psi_mean.Rds&quot;</span><span class="p">)</span>
psi_3_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
psi_4_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
psi_5_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
psi_6_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
psi_7_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span> <span class="p">{</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/@{i}.Rds&quot;</span><span class="p">))</span>
  psi_3_mean <span class="o">&lt;-</span> psi_3_mean <span class="o">+</span> <span class="p">(</span>psi <span class="o">-</span> psi_mean<span class="p">)</span><span class="o">^</span><span class="m">3</span>
  psi_4_mean <span class="o">&lt;-</span> psi_4_mean <span class="o">+</span> <span class="p">(</span>psi <span class="o">-</span> psi_mean<span class="p">)</span><span class="o">^</span><span class="m">4</span>
  psi_5_mean <span class="o">&lt;-</span> psi_5_mean <span class="o">+</span> <span class="p">(</span>psi <span class="o">-</span> psi_mean<span class="p">)</span><span class="o">^</span><span class="m">5</span>
  psi_6_mean <span class="o">&lt;-</span> psi_6_mean <span class="o">+</span> <span class="p">(</span>psi <span class="o">-</span> psi_mean<span class="p">)</span><span class="o">^</span><span class="m">6</span>
  psi_7_mean <span class="o">&lt;-</span> psi_7_mean <span class="o">+</span> <span class="p">(</span>psi <span class="o">-</span> psi_mean<span class="p">)</span><span class="o">^</span><span class="m">7</span>
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>
psi_3_mean <span class="o">&lt;-</span> psi_3_mean <span class="o">/</span> <span class="m">1000</span>
psi_4_mean <span class="o">&lt;-</span> psi_4_mean <span class="o">/</span> <span class="m">1000</span>
psi_5_mean <span class="o">&lt;-</span> psi_5_mean <span class="o">/</span> <span class="m">1000</span>
psi_6_mean <span class="o">&lt;-</span> psi_6_mean <span class="o">/</span> <span class="m">1000</span>
psi_7_mean <span class="o">&lt;-</span> psi_7_mean <span class="o">/</span> <span class="m">1000</span>

<span class="c1"># save for later usage</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_3_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/higher_moments/psi_3_mean.Rds&quot;</span><span class="p">)</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_4_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/higher_moments/psi_4_mean.Rds&quot;</span><span class="p">)</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_5_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/higher_moments/psi_5_mean.Rds&quot;</span><span class="p">)</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_6_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/higher_moments/psi_6_mean.Rds&quot;</span><span class="p">)</span>
<span class="kp">saveRDS</span><span class="p">(</span>psi_7_mean<span class="p">,</span> <span class="s">&quot;~/working/jet_stat_model_data/higher_moments/psi_7_mean.Rds&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Eddy_Anisotropy">Eddy Anisotropy</span></h2>
<p>Eddy anisotropy is a measure of deformation of eddies that is computed based on their statistics (in particular, it depends on the covariance of zonal and meridional velocities).
</p>
<h3><span class="mw-headline" id="Time_mean_eddy_anisotropy">Time mean eddy anisotropy</span></h3>
<p>One way to compute eddy anisotropy is by treating the mean as a time mean, for a fixed spatial location. Note that this approach might miss transient eddies (eddies that move around the flow in a periodic fashion). Also in Laure Zanna's paper, spatial averages are used. Hence, perhaps it makes more sense to use spatial means to compute eddy anisotropy as well?
</p><p>Of course, for our model, both approaches might give the same result since the flow is in a statistically stable state.
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute time mean eddy anisotropy
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>

<span class="c1"># compute eddy anisotropy L using time-mean</span>
<span class="c1"># note: did you know that this approach completely kills transient eddies? (i.e. eddies that travel around)</span>
psi_mean <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_stat_model_data/psi_mean.Rds&quot;</span><span class="p">)</span>

uu_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
vv_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
uv_mean <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span> <span class="p">{</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/@{i}.Rds&quot;</span><span class="p">))</span>
  psi_dev <span class="o">&lt;-</span> psi <span class="o">-</span> psi_mean
  psi_dev_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi_dev<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  
  u_dev <span class="o">=</span> <span class="o">-</span>psi_dev_grad<span class="o">$</span>Y
  v_dev <span class="o">=</span> psi_dev_grad<span class="o">$</span>X
  
  uu <span class="o">=</span> u_dev<span class="o">^</span><span class="m">2</span>
  vv <span class="o">=</span> v_dev<span class="o">^</span><span class="m">2</span>
  uv <span class="o">=</span> u_dev<span class="o">*</span>v_dev
  
  uu_mean <span class="o">&lt;-</span> uu_mean <span class="o">+</span> uu
  vv_mean <span class="o">&lt;-</span> vv_mean <span class="o">+</span> vv
  uv_mean <span class="o">&lt;-</span> uv_mean <span class="o">+</span> uv
  
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>

uu_mean <span class="o">&lt;-</span> uu_mean<span class="o">/</span><span class="m">1000</span>
vv_mean <span class="o">&lt;-</span> vv_mean<span class="o">/</span><span class="m">1000</span>
uv_mean <span class="o">&lt;-</span> uv_mean<span class="o">/</span><span class="m">1000</span>

M <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="o">*</span><span class="p">(</span>uu_mean <span class="o">-</span> vv_mean<span class="p">)</span>
N <span class="o">&lt;-</span> uv_mean

L <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>M<span class="o">^</span><span class="m">2</span> <span class="o">+</span> N<span class="o">^</span><span class="m">2</span><span class="p">)</span>

<span class="kp">saveRDS</span><span class="p">(</span>L<span class="p">,</span> <span class="s">&quot;~/working/jet_eddy_anisotropy_time_mean.Rds&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot time mean eddy anisotropy
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>L <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_eddy_anisotropy_time_mean.Rds&quot;</span><span class="p">)</span>

<span class="c1"># plot</span>
png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_anisotropy_time_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
imagep<span class="p">(</span>L<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Time mean eddy anisotropy&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_anisotropy_time_mean_meridional_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">-400</span><span class="o">:</span><span class="m">400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">colMeans</span><span class="p">(</span>L<span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged meridional time mean eddy anisotropy&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_anisotropy_time_mean_zonal_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">rowMeans</span><span class="p">(</span>L<span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged zonal time mean eddy anisotropy&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_time_mean.png.html" class="image"><img alt="" src="images/thumb/b/bc/Eddy_geometry_deformation_eddy_anisotropy_time_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_time_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/b/bc/Eddy_geometry_deformation_eddy_anisotropy_time_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_time_mean.png 1.5x, images/thumb/b/bc/Eddy_geometry_deformation_eddy_anisotropy_time_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_time_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Time mean eddy anisotropy
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/2/2e/Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/2/2e/Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png 1.5x, images/thumb/2/2e/Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_time_mean_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/d/d4/Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/d/d4/Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png 1.5x, images/thumb/d/d4/Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_time_mean_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
</ul>
<h3><span class="mw-headline" id="Spatial_mean_eddy_anisotropy">Spatial mean eddy anisotropy</span></h3>
<p>To be more in spirit with the Laure Zanna's article, we probably should compute eddy anisotropy using spatial means.
</p><p>Here we use a Gaussian kernel to compute the means, with standard deviation <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sigma =5}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C3;<!-- σ --></mi>
        <mo>=</mo>
        <mn>5</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sigma =5}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/91acecaa85bb9fd3396ec0b9976a1e14e2899960" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.591ex; height:2.176ex;" alt="{\displaystyle \sigma =5}"/></span>, that is equivalent to 20 km. In general, one <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sigma }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C3;<!-- σ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sigma }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/59f59b7c3e6fdb1d0365a494b81fb9a696138c36" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.33ex; height:1.676ex;" alt="{\displaystyle \sigma }"/></span> (or cell size in the model) equals 4 km.
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute spatial mean eddy anisotropy
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>
<span class="kn">library</span><span class="p">(</span>imagine<span class="p">)</span> <span class="c1"># Convolution</span>

<span class="c1"># probably should be between 1 and 20</span>
spatial_averaging_scale <span class="o">=</span> <span class="m">5</span>

<span class="c1"># compute eddy anisotropy L using spatial mean (instantaneous)</span>
psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/10.Rds&quot;</span><span class="p">)</span>
psi_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>psi<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>

psi_dev <span class="o">&lt;-</span> psi <span class="o">-</span> psi_mean
psi_dev_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi_dev<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
u_dev <span class="o">&lt;-</span> <span class="o">-</span>psi_dev_grad<span class="o">$</span>Y
v_dev <span class="o">&lt;-</span> psi_dev_grad<span class="o">$</span>X
uu <span class="o">&lt;-</span> u_dev<span class="o">^</span><span class="m">2</span>
vv <span class="o">&lt;-</span> v_dev<span class="o">^</span><span class="m">2</span>
uv <span class="o">&lt;-</span> u_dev<span class="o">*</span>v_dev

uu_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>uu<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
vv_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>vv<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
uv_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>uv<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>

M <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="o">*</span><span class="p">(</span>uu_mean <span class="o">-</span> vv_mean<span class="p">)</span>
N <span class="o">&lt;-</span> uv_mean

L <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>M<span class="o">^</span><span class="m">2</span> <span class="o">+</span> N<span class="o">^</span><span class="m">2</span><span class="p">)</span>

<span class="kp">saveRDS</span><span class="p">(</span>L<span class="p">,</span> <span class="s">&quot;~/working/jet_eddy_anisotropy_spatial_mean.Rds&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<p>We can then plot this:
</p><p>Note: Computing averages introduces artifacts near the borders of the flow, where there's not enough data to compute averages. Lucky, in R there is a special placeholder for such cases - NA.
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot spatial mean eddy anisotropy
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>L <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_eddy_anisotropy_spatial_mean.Rds&quot;</span><span class="p">)</span>

<span class="c1"># plot</span>
png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_anisotropy_spatial_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
imagep<span class="p">(</span>L<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Spatial mean eddy anisotropy&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_anisotropy_spatial_mean_meridional_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">-400</span><span class="o">:</span><span class="m">400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">colMeans</span><span class="p">(</span>L<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged meridional spatial mean eddy anisotropy&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_anisotropy_spatial_mean_zonal_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">rowMeans</span><span class="p">(</span>L<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Averaged zonal spatial mean eddy anisotropy&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png.html" class="image"><img alt="" src="images/thumb/9/98/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/9/98/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png 1.5x, images/thumb/9/98/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Spatial mean eddy anisotropy
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/3/36/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/3/36/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png 1.5x, images/thumb/3/36/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/3/3c/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/3/3c/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png 1.5x, images/thumb/3/3c/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
</ul>
<div style="background-color: plum; border-style: solid; margin: 10px; padding: 10px; display:inline-block">
<p>TODO: Can we have a movie of spatial-mean eddy anisotropy? Also can study the time-statistics.
</p>
</div>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute time series of spatial mean eddy anisotropy
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>
<span class="kn">library</span><span class="p">(</span>imagine<span class="p">)</span> <span class="c1"># Convolution</span>

<span class="c1"># probably should be between 1 and 20</span>
spatial_averaging_scale <span class="o">=</span> <span class="m">5</span>

compute_eddy_anosptropy_L_spatial_mean_at <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>i<span class="p">)</span> <span class="p">{</span>
  <span class="c1"># compute eddy anisotropy L using spatial mean (instantaneous)</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/@{i}.Rds&quot;</span><span class="p">))</span>
  psi_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>psi<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  
  psi_dev <span class="o">&lt;-</span> psi <span class="o">-</span> psi_mean
  psi_dev_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi_dev<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  u_dev <span class="o">&lt;-</span> <span class="o">-</span>psi_dev_grad<span class="o">$</span>Y
  v_dev <span class="o">&lt;-</span> psi_dev_grad<span class="o">$</span>X
  uu <span class="o">&lt;-</span> u_dev<span class="o">^</span><span class="m">2</span>
  vv <span class="o">&lt;-</span> v_dev<span class="o">^</span><span class="m">2</span>
  uv <span class="o">&lt;-</span> u_dev<span class="o">*</span>v_dev
  
  uu_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>uu<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  vv_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>vv<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  uv_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>uv<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  
  M <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="o">*</span><span class="p">(</span>uu_mean <span class="o">-</span> vv_mean<span class="p">)</span>
  N <span class="o">&lt;-</span> uv_mean
  
  L <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>M<span class="o">^</span><span class="m">2</span> <span class="o">+</span> N<span class="o">^</span><span class="m">2</span><span class="p">)</span>

  L
<span class="p">}</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span> <span class="p">{</span>
  L <span class="o">&lt;-</span> compute_eddy_anosptropy_L_spatial_mean_at<span class="p">(</span>i<span class="p">)</span>
  <span class="kp">saveRDS</span><span class="p">(</span>L<span class="p">,</span> qq<span class="p">(</span><span class="s">&quot;~/working/time_series/jet_eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute mean and std
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">source</span><span class="p">(</span><span class="s">&quot;~/working/reusable_functions/compute_mean_and_std.R&quot;</span><span class="p">)</span>
compute_mean_and_std<span class="p">(</span><span class="s">&quot;~/working/time_series/jet_eddy_anisotropy_spatial_mean&quot;</span><span class="p">,</span>
                     <span class="s">&quot;~/working/time_series_stat/jet_eddy_anisotropy_spatial_mean&quot;</span><span class="p">,</span>
                     <span class="m">1000</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot mean and std
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">source</span><span class="p">(</span><span class="s">&quot;~/working/reusable_functions/plot_mean_and_std.R&quot;</span><span class="p">)</span>
plot_mean_and_std<span class="p">(</span><span class="s">&quot;~/working/time_series_stat/jet_eddy_anisotropy_spatial_mean&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png.html" class="image"><img alt="" src="images/thumb/a/aa/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/a/aa/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png 1.5x, images/thumb/a/aa/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png.html" class="image"><img alt="" src="images/thumb/4/41/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png" decoding="async" width="240" height="120" srcset="images/thumb/4/41/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png 1.5x, images/thumb/4/41/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>STD
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/1/1a/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/1/1a/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png 1.5x, images/thumb/1/1a/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/1/1a/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/1/1a/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png 1.5x, images/thumb/1/1a/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png.html" class="image"><img alt="" src="images/thumb/d/df/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png" decoding="async" width="240" height="120" srcset="images/thumb/d/df/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png 1.5x, images/thumb/d/df/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_meridional_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional STD
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png.html" class="image"><img alt="" src="images/thumb/0/07/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png/360px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png" decoding="async" width="240" height="120" srcset="images/thumb/0/07/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png/540px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png 1.5x, images/thumb/0/07/Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png/720px-Eddy_geometry_deformation_eddy_anisotropy_spatial_mean_time_stat_zonal_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal STD
</p>
			</div>
		</div></li>
</ul>
<h2><span class="mw-headline" id="Product_of_large-scale_deformation_and_vorticity">Product of large-scale deformation and vorticity</span></h2>
<h3><span class="mw-headline" id="Time_mean">Time mean</span></h3>
<p>Time mean = time average = time large-scale field
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute product of vorticity and deformation for time large-scale field
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>

psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_stat_model_data/psi_mean.Rds&quot;</span><span class="p">)</span>

psi_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
u <span class="o">&lt;-</span> <span class="o">-</span>psi_grad<span class="o">$</span>Y
v <span class="o">&lt;-</span> psi_grad<span class="o">$</span>X

u_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>u<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
v_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>v<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>

D <span class="o">&lt;-</span> u_grad<span class="o">$</span>Y <span class="o">+</span> v_grad<span class="o">$</span>X
D_T <span class="o">&lt;-</span> u_grad<span class="o">$</span>X <span class="o">-</span> v_grad<span class="o">$</span>Y

delta <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>D<span class="o">^</span><span class="m">2</span> <span class="o">+</span> D_T<span class="o">^</span><span class="m">2</span><span class="p">)</span>
vorticity <span class="o">&lt;-</span> v_grad<span class="o">$</span>X <span class="o">-</span> u_grad<span class="o">$</span>Y<span class="p">;</span>

vort_def_prod <span class="o">&lt;-</span> <span class="kp">abs</span><span class="p">(</span>vorticity<span class="p">)</span><span class="o">*</span>delta

<span class="kp">saveRDS</span><span class="p">(</span>vort_def_prod<span class="p">,</span> <span class="s">&quot;~/working/jet_vort_def_prod_time_mean.Rds&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot product of vorticity and deformation for time large-scale field
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_vort_def_prod_time_mean.Rds&quot;</span><span class="p">)</span>

<span class="c1"># plot</span>
png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;jet_vort_def_prod_time_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
imagep<span class="p">(</span>vort_def_prod<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Time mean product of vorticity and deformation&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;jet_vort_def_prod_time_mean_meridional_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">-400</span><span class="o">:</span><span class="m">400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">colMeans</span><span class="p">(</span>vort_def_prod<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Averaged meridional time mean product of vorticity and deformation&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;jet_vort_def_prod_time_mean_zonal_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">rowMeans</span><span class="p">(</span>vort_def_prod<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Averaged zonal time mean product of vorticity and deformation&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png.html" class="image"><img alt="" src="images/thumb/9/9d/Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/9/9d/Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png 1.5x, images/thumb/9/9d/Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Time mean product of vorticity and deformation
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/2/29/Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/2/29/Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png 1.5x, images/thumb/2/29/Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/a/a0/Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/a/a0/Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png 1.5x, images/thumb/a/a0/Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_time_mean_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
</ul>
<h3><span class="mw-headline" id="Spatial_mean">Spatial mean</span></h3>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute product of vorticity and deformation for spatial large-scale field
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>
<span class="kn">library</span><span class="p">(</span>imagine<span class="p">)</span> <span class="c1"># Convolution</span>

<span class="c1"># probably should be between 1 and 20</span>
spatial_averaging_scale <span class="o">=</span> <span class="m">5</span>

<span class="c1"># compute eddy anisotropy L using spatial mean (instantaneous)</span>
psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/10.Rds&quot;</span><span class="p">)</span>
psi_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>psi<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
<span class="c1"># psi_mean is large-scale streamfunction field</span>
psi <span class="o">&lt;-</span> psi_mean <span class="c1"># we won&#39;t need small-scale field anymore</span>

psi_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
u <span class="o">&lt;-</span> <span class="o">-</span>psi_grad<span class="o">$</span>Y
v <span class="o">&lt;-</span> psi_grad<span class="o">$</span>X

u_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>u<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
v_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>v<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>

D <span class="o">&lt;-</span> u_grad<span class="o">$</span>Y <span class="o">+</span> v_grad<span class="o">$</span>X
D_T <span class="o">&lt;-</span> u_grad<span class="o">$</span>X <span class="o">-</span> v_grad<span class="o">$</span>Y

delta <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>D<span class="o">^</span><span class="m">2</span> <span class="o">+</span> D_T<span class="o">^</span><span class="m">2</span><span class="p">)</span>
vorticity <span class="o">&lt;-</span> v_grad<span class="o">$</span>X <span class="o">-</span> u_grad<span class="o">$</span>Y<span class="p">;</span>

vort_def_prod <span class="o">&lt;-</span> <span class="kp">abs</span><span class="p">(</span>vorticity<span class="p">)</span><span class="o">*</span>delta

<span class="kp">saveRDS</span><span class="p">(</span>vort_def_prod<span class="p">,</span> <span class="s">&quot;~/working/jet_vort_def_prod_spatial_mean.Rds&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot product of vorticity and deformation for spatial large-scale field
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/jet_vort_def_prod_spatial_mean.Rds&quot;</span><span class="p">)</span>

<span class="c1"># plot</span>
png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;jet_vort_def_prod_spatial_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
imagep<span class="p">(</span>vort_def_prod<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Spatial mean product of vorticity and deformation&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;jet_vort_def_prod_spatial_mean_meridional_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">-400</span><span class="o">:</span><span class="m">400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">colMeans</span><span class="p">(</span>vort_def_prod<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Averaged meridional spatial mean product of vorticity and deformation&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;jet_vort_def_prod_spatial_mean_zonal_mean.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
plot<span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
     <span class="kp">rowMeans</span><span class="p">(</span>vort_def_prod<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
     xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Averaged zonal spatial mean product of vorticity and deformation&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png.html" class="image"><img alt="" src="images/thumb/d/d3/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/d/d3/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png 1.5x, images/thumb/d/d3/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Spatial mean product of vorticity and deformation
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/f/f7/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/f/f7/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png 1.5x, images/thumb/f/f7/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/4/4d/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/4/4d/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png 1.5x, images/thumb/4/4d/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
</ul>
<div style="background-color: plum; border-style: solid; margin: 10px; padding: 10px; display:inline-block">
<p>Note: We can improve visibility of small-scale features by computing something like '(delta+0.2)*(abs(vorticity)+0.2)' instead of '(delta)*(abs(vorticity))'.
</p>
</div>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute time series of product of vorticity and deformation for spatial large-scale field
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>
<span class="kn">library</span><span class="p">(</span>imagine<span class="p">)</span> <span class="c1"># Convolution</span>

<span class="c1"># probably should be between 1 and 20</span>
spatial_averaging_scale <span class="o">=</span> <span class="m">5</span>

compute_vorticity_deformation_product_at <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>i<span class="p">)</span> <span class="p">{</span>
  <span class="c1"># compute eddy anisotropy L using spatial mean (instantaneous)</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/@{i}.Rds&quot;</span><span class="p">))</span>
  psi_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>psi<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  <span class="c1"># psi_mean is large-scale streamfunction field</span>
  psi <span class="o">&lt;-</span> psi_mean <span class="c1"># we won&#39;t need small-scale field anymore</span>
  
  psi_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  u <span class="o">&lt;-</span> <span class="o">-</span>psi_grad<span class="o">$</span>Y
  v <span class="o">&lt;-</span> psi_grad<span class="o">$</span>X
  
  u_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>u<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  v_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>v<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  
  D <span class="o">&lt;-</span> u_grad<span class="o">$</span>Y <span class="o">+</span> v_grad<span class="o">$</span>X
  D_T <span class="o">&lt;-</span> u_grad<span class="o">$</span>X <span class="o">-</span> v_grad<span class="o">$</span>Y
  
  delta <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>D<span class="o">^</span><span class="m">2</span> <span class="o">+</span> D_T<span class="o">^</span><span class="m">2</span><span class="p">)</span>
  vorticity <span class="o">&lt;-</span> v_grad<span class="o">$</span>X <span class="o">-</span> u_grad<span class="o">$</span>Y<span class="p">;</span>
  
  vort_def_prod <span class="o">&lt;-</span> <span class="kp">abs</span><span class="p">(</span>vorticity<span class="p">)</span><span class="o">*</span>delta

  vort_def_prod
<span class="p">}</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span> <span class="p">{</span>
  vort_def_prod <span class="o">&lt;-</span> compute_vorticity_deformation_product_at<span class="p">(</span>i<span class="p">)</span>
  <span class="kp">saveRDS</span><span class="p">(</span>vort_def_prod<span class="p">,</span> qq<span class="p">(</span><span class="s">&quot;~/working/time_series/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute mean and std
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">source</span><span class="p">(</span><span class="s">&quot;~/working/reusable_functions/compute_mean_and_std.R&quot;</span><span class="p">)</span>
compute_mean_and_std<span class="p">(</span><span class="s">&quot;~/working/time_series/vorticity_deformation_product_spatial_mean&quot;</span><span class="p">,</span>
                     <span class="s">&quot;~/working/time_series_stat/vorticity_deformation_product_spatial_mean&quot;</span><span class="p">,</span>
                     <span class="m">1000</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot mean and std
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">source</span><span class="p">(</span><span class="s">&quot;~/working/reusable_functions/plot_mean_and_std.R&quot;</span><span class="p">)</span>
plot_mean_and_std<span class="p">(</span><span class="s">&quot;~/working/time_series_stat/vorticity_deformation_product_spatial_mean&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png.html" class="image"><img alt="" src="images/thumb/c/c9/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/c/c9/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png 1.5x, images/thumb/c/c9/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png.html" class="image"><img alt="" src="images/thumb/5/5f/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png" decoding="async" width="240" height="120" srcset="images/thumb/5/5f/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png 1.5x, images/thumb/5/5f/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>STD
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png.html" class="image"><img alt="" src="images/thumb/f/f7/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/f/f7/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png 1.5x, images/thumb/f/f7/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png.html" class="image"><img alt="" src="images/thumb/c/c9/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png" decoding="async" width="240" height="120" srcset="images/thumb/c/c9/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png 1.5x, images/thumb/c/c9/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_mean.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal mean
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png.html" class="image"><img alt="" src="images/thumb/a/a1/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png" decoding="async" width="240" height="120" srcset="images/thumb/a/a1/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png 1.5x, images/thumb/a/a1/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_meridional_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Meridional STD
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png.html" class="image"><img alt="" src="images/thumb/4/4c/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png/360px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png" decoding="async" width="240" height="120" srcset="images/thumb/4/4c/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png/540px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png 1.5x, images/thumb/4/4c/Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png/720px-Eddy_geometry_deformation_jet_vort_def_prod_spatial_mean_time_stat_zonal_std.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Zonal STD
</p>
			</div>
		</div></li>
</ul>
<h2><span class="mw-headline" id="Comparing_eddy_anisotropy_to_deformation_and_vorticity_product">Comparing eddy anisotropy to deformation and vorticity product</span></h2>
<p>We now need to figure out which regions in the field we actually want to study. We also can just try the overall fields, but it might be a good idea to pick regions where we expect the parametrization to work well, and then fine-tune the details there. Only after that try to generalize it for the overall field (while also checking that things still make sense).
</p><p>As we can see from above, time statistics of spatial eddy anisotropy and vorticity deformation product look quite similar except for some regions. In particular, they look different in the upstream region right at the center of the jet, and near the maximum of eddy kinetic energy. This is consistent with the presentation (see references).
</p><p>Now, to figure out the best partition scale at a point, we should pick a point where both fields fit nicely, and try out different partitioning scales.
</p><p>Also notice that the meridional profile of vorticity deformation parametrization is not as bulged near the gyres as the eddy anisotropy profile. This might suggest that those regions require different spatial scales (rather than the global one above which was set to about 20 km, or <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sigma =5}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C3;<!-- σ --></mi>
        <mo>=</mo>
        <mn>5</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sigma =5}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/91acecaa85bb9fd3396ec0b9976a1e14e2899960" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.591ex; height:2.176ex;" alt="{\displaystyle \sigma =5}"/></span>). This might be the case because those gyres are much more local effect, so information about them is lost for such large partitioning scale.
</p><p>Notice that time mean <i>vorticity deformation</i> and <i>eddy anisotropy</i> don't match as much as spatial mean <i>vorticity deformation</i> and <i>eddy anisotropy</i> do. Actually in the second case there seems to be a lot of similarity. But, as we have noticed from the average meridional slices, spatial partitioning scales are likely to be different for different places in the flow. We need to get this separation right. In the next section we will study dependence of similarity on spatial mean in further detail.
</p><p>I actually think that image plots of mean and svd of these two fields look very similar (with account for position-depending partitioning scale and also upstream and max EKE regions where parametrization breaks).
</p>
<h3><span class="mw-headline" id="Comparing_at_a_point">Comparing at a point</span></h3>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot the point on top of svd plots of vorticity deformation and eddy anisotropy
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>eddy_ani_std <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/time_series_stat/jet_eddy_anisotropy_spatial_mean/std.Rds&quot;</span><span class="p">)</span>
vort_def_std <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/time_series_stat/vorticity_deformation_product_spatial_mean/std.Rds&quot;</span><span class="p">)</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_ani_std_sample_point.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>

imagep<span class="p">(</span>eddy_ani_std<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Eddy Anisotropy STD&quot;</span><span class="p">)</span>
<span class="c1">#points(350,300, col=&quot;red&quot;, pch=11)</span>
points<span class="p">(</span><span class="m">350</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,(</span><span class="m">300-400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">11</span><span class="p">)</span>

dev.off<span class="p">()</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;vort_def_std_sample_point.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>

<span class="c1">#imagep(vort_def_std)</span>
imagep<span class="p">(</span>vort_def_std<span class="p">,</span>
       decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
       x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
       useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
       main<span class="o">=</span><span class="s">&quot;Vorticity Deformation STD&quot;</span><span class="p">)</span>
points<span class="p">(</span><span class="m">350</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,(</span><span class="m">300-400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">11</span><span class="p">)</span>

dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_ani_std_sample_point.png.html" class="image"><img alt="" src="images/thumb/7/79/Eddy_geometry_deformation_eddy_ani_std_sample_point.png/360px-Eddy_geometry_deformation_eddy_ani_std_sample_point.png" decoding="async" width="240" height="120" srcset="images/thumb/7/79/Eddy_geometry_deformation_eddy_ani_std_sample_point.png/540px-Eddy_geometry_deformation_eddy_ani_std_sample_point.png 1.5x, images/thumb/7/79/Eddy_geometry_deformation_eddy_ani_std_sample_point.png/720px-Eddy_geometry_deformation_eddy_ani_std_sample_point.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Chosen point plotted on top of eddy anisotropy STD field
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_vort_def_std_sample_point.png.html" class="image"><img alt="" src="images/thumb/e/eb/Eddy_geometry_deformation_vort_def_std_sample_point.png/360px-Eddy_geometry_deformation_vort_def_std_sample_point.png" decoding="async" width="240" height="120" srcset="images/thumb/e/eb/Eddy_geometry_deformation_vort_def_std_sample_point.png/540px-Eddy_geometry_deformation_vort_def_std_sample_point.png 1.5x, images/thumb/e/eb/Eddy_geometry_deformation_vort_def_std_sample_point.png/720px-Eddy_geometry_deformation_vort_def_std_sample_point.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Chosen point plotted on top of vorticity deformation STD field
</p>
			</div>
		</div></li>
</ul>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot the averaging function at a point as a function of partitioning scale. SVD of vorticity deformation field is overlaid on top.
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>

plot_averaging_function_at_a_point <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>spatial_averaging_scale<span class="p">)</span> <span class="p">{</span>
  point <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">350</span><span class="p">,</span><span class="m">300</span><span class="p">)</span>
  <span class="c1">#spatial_averaging_scale &lt;- 30 #5</span>
  
  averaging_function <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0L</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">1</span><span class="p">],</span> ncol <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>psi_mean<span class="p">)[</span><span class="m">2</span><span class="p">])</span>
  kernel <span class="o">&lt;-</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span>
  
  from_x <span class="o">&lt;-</span> <span class="o">-</span><span class="kp">floor</span><span class="p">(</span><span class="kp">dim</span><span class="p">(</span>kernel<span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span> point<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="m">+1</span>
  to_x <span class="o">&lt;-</span> <span class="kp">dim</span><span class="p">(</span>kernel<span class="p">)[</span><span class="m">1</span><span class="p">]</span> <span class="o">-</span> <span class="kp">floor</span><span class="p">(</span><span class="kp">dim</span><span class="p">(</span>kernel<span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span> point<span class="p">[</span><span class="m">1</span><span class="p">]</span>
  
  from_y <span class="o">&lt;-</span> <span class="o">-</span><span class="kp">floor</span><span class="p">(</span><span class="kp">dim</span><span class="p">(</span>kernel<span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span> point<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="m">+1</span>
  to_y <span class="o">&lt;-</span> <span class="kp">dim</span><span class="p">(</span>kernel<span class="p">)[</span><span class="m">2</span><span class="p">]</span> <span class="o">-</span> <span class="kp">floor</span><span class="p">(</span><span class="kp">dim</span><span class="p">(</span>kernel<span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span> point<span class="p">[</span><span class="m">2</span><span class="p">]</span>
  
  averaging_function<span class="p">[</span>from_x<span class="o">:</span>to_x<span class="p">,</span>from_y<span class="o">:</span>to_y<span class="p">]</span> <span class="o">&lt;-</span> kernel
  
  
  <span class="c1"># plot</span>
  png<span class="p">(</span>file<span class="o">=</span>qq<span class="p">(</span><span class="s">&quot;averaging_function_@{spatial_averaging_scale}.png&quot;</span><span class="p">),</span>
      width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
      height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
      pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
  imagep<span class="p">(</span>averaging_function<span class="p">,</span>
         decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
         x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
         y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
         ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
         xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
         useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
         main<span class="o">=</span>qq<span class="p">(</span><span class="s">&quot;Averaging function for spatial scale of @{spatial_averaging_scale}&quot;</span><span class="p">))</span>
  <span class="c1"># add contour</span>
  contour<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="kp">dim</span><span class="p">(</span>vort_def_std<span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span> <span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="kp">dim</span><span class="p">(</span>vort_def_std<span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="m">-400</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span> vort_def_std<span class="p">,</span> add<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
  dev.off<span class="p">()</span>
<span class="p">}</span>

plot_averaging_function_at_a_point<span class="p">(</span><span class="m">5</span><span class="p">)</span>
plot_averaging_function_at_a_point<span class="p">(</span><span class="m">20</span><span class="p">)</span>
plot_averaging_function_at_a_point<span class="p">(</span><span class="m">30</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_averaging_function_30.png.html" class="image"><img alt="" src="images/thumb/6/62/Eddy_geometry_deformation_averaging_function_30.png/360px-Eddy_geometry_deformation_averaging_function_30.png" decoding="async" width="240" height="120" srcset="images/thumb/6/62/Eddy_geometry_deformation_averaging_function_30.png/540px-Eddy_geometry_deformation_averaging_function_30.png 1.5x, images/thumb/6/62/Eddy_geometry_deformation_averaging_function_30.png/720px-Eddy_geometry_deformation_averaging_function_30.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>30
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_averaging_function_20.png.html" class="image"><img alt="" src="images/thumb/7/7d/Eddy_geometry_deformation_averaging_function_20.png/360px-Eddy_geometry_deformation_averaging_function_20.png" decoding="async" width="240" height="120" srcset="images/thumb/7/7d/Eddy_geometry_deformation_averaging_function_20.png/540px-Eddy_geometry_deformation_averaging_function_20.png 1.5x, images/thumb/7/7d/Eddy_geometry_deformation_averaging_function_20.png/720px-Eddy_geometry_deformation_averaging_function_20.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>20
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_averaging_function_5.png.html" class="image"><img alt="" src="images/thumb/8/89/Eddy_geometry_deformation_averaging_function_5.png/360px-Eddy_geometry_deformation_averaging_function_5.png" decoding="async" width="240" height="120" srcset="images/thumb/8/89/Eddy_geometry_deformation_averaging_function_5.png/540px-Eddy_geometry_deformation_averaging_function_5.png 1.5x, images/thumb/8/89/Eddy_geometry_deformation_averaging_function_5.png/720px-Eddy_geometry_deformation_averaging_function_5.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>5
</p>
			</div>
		</div></li>
</ul>
<p>Judging from spatial structure of vorticity SVD, optimal partitioning scale for this point should be somewhere between 5 and 20, and definitely not much larger than 20.
</p><p>Now, lets compute both fields for one time-step of the field:
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to compute vorticity deformation product at a time step for a number of different partitioning scales
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>
<span class="kn">library</span><span class="p">(</span>imagine<span class="p">)</span> <span class="c1"># Convolution</span>

compute_vorticity_deformation_product_for_spatial_averaging_scale <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>spatial_averaging_scale<span class="p">)</span> <span class="p">{</span>
  <span class="c1"># compute eddy anisotropy L using spatial mean (instantaneous)</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/1.Rds&quot;</span><span class="p">))</span>
  psi_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>psi<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  <span class="c1"># psi_mean is large-scale streamfunction field</span>
  psi <span class="o">&lt;-</span> psi_mean <span class="c1"># we won&#39;t need small-scale field anymore</span>
  
  psi_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  u <span class="o">&lt;-</span> <span class="o">-</span>psi_grad<span class="o">$</span>Y
  v <span class="o">&lt;-</span> psi_grad<span class="o">$</span>X
  
  u_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>u<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  v_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>v<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  
  D <span class="o">&lt;-</span> u_grad<span class="o">$</span>Y <span class="o">+</span> v_grad<span class="o">$</span>X
  D_T <span class="o">&lt;-</span> u_grad<span class="o">$</span>X <span class="o">-</span> v_grad<span class="o">$</span>Y
  
  delta <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>D<span class="o">^</span><span class="m">2</span> <span class="o">+</span> D_T<span class="o">^</span><span class="m">2</span><span class="p">)</span>
  vorticity <span class="o">&lt;-</span> v_grad<span class="o">$</span>X <span class="o">-</span> u_grad<span class="o">$</span>Y<span class="p">;</span>
  
  vort_def_prod <span class="o">&lt;-</span> <span class="kp">abs</span><span class="p">(</span>vorticity<span class="p">)</span><span class="o">*</span>delta
  
  vort_def_prod
<span class="p">}</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">)</span> <span class="p">{</span>
  vort_def_prod <span class="o">&lt;-</span> compute_vorticity_deformation_product_for_spatial_averaging_scale<span class="p">(</span>i<span class="p">)</span>
  <span class="kp">saveRDS</span><span class="p">(</span>vort_def_prod<span class="p">,</span> qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to eddy anisotropy at a time step for a number of different partitioning scales
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>pracma<span class="p">)</span> <span class="c1"># To compute derivatives</span>
<span class="kn">library</span><span class="p">(</span>spatialfil<span class="p">)</span> <span class="c1"># Gaussian kernel</span>
<span class="kn">library</span><span class="p">(</span>imagine<span class="p">)</span> <span class="c1"># Convolution</span>

compute_eddy_anisotropy_for_spatial_averaging_scale <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>spatial_averaging_scale<span class="p">)</span> <span class="p">{</span>
  <span class="c1"># compute eddy anisotropy L using spatial mean (instantaneous)</span>
  psi <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/jet_time_model_data/1.Rds&quot;</span><span class="p">))</span>
  psi_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>psi<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  
  psi_dev <span class="o">&lt;-</span> psi <span class="o">-</span> psi_mean
  psi_dev_grad <span class="o">&lt;-</span> gradient<span class="p">(</span>psi_dev<span class="p">,</span> <span class="m">0.1</span><span class="p">)</span>
  u_dev <span class="o">&lt;-</span> <span class="o">-</span>psi_dev_grad<span class="o">$</span>Y
  v_dev <span class="o">&lt;-</span> psi_dev_grad<span class="o">$</span>X
  uu <span class="o">&lt;-</span> u_dev<span class="o">^</span><span class="m">2</span>
  vv <span class="o">&lt;-</span> v_dev<span class="o">^</span><span class="m">2</span>
  uv <span class="o">&lt;-</span> u_dev<span class="o">*</span>v_dev
  
  uu_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>uu<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  vv_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>vv<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  uv_mean <span class="o">&lt;-</span> convolution2D<span class="p">(</span>uv<span class="p">,</span> convKernel<span class="p">(</span>sigma <span class="o">=</span> spatial_averaging_scale<span class="p">,</span> k <span class="o">=</span> <span class="s">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">$</span><span class="kt">matrix</span><span class="p">)</span>
  
  M <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="o">*</span><span class="p">(</span>uu_mean <span class="o">-</span> vv_mean<span class="p">)</span>
  N <span class="o">&lt;-</span> uv_mean
  
  L <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span>M<span class="o">^</span><span class="m">2</span> <span class="o">+</span> N<span class="o">^</span><span class="m">2</span><span class="p">)</span>
  
  L
<span class="p">}</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">)</span> <span class="p">{</span>
  L <span class="o">&lt;-</span> compute_eddy_anisotropy_for_spatial_averaging_scale<span class="p">(</span>i<span class="p">)</span>
  <span class="kp">saveRDS</span><span class="p">(</span>L<span class="p">,</span> qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
  <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot eddy anisotropy and vorticity deformation side by side for several partitioning scales
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

vort_def_prod1 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/1.Rds&quot;</span><span class="p">)</span>
eddy_anisotropy1 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/1.Rds&quot;</span><span class="p">)</span>

vort_def_prod2 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/2.Rds&quot;</span><span class="p">)</span>
eddy_anisotropy2 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/2.Rds&quot;</span><span class="p">)</span>

vort_def_prod5 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/5.Rds&quot;</span><span class="p">)</span>
eddy_anisotropy5 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/5.Rds&quot;</span><span class="p">)</span>

vort_def_prod10 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/10.Rds&quot;</span><span class="p">)</span>
eddy_anisotropy10 <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/10.Rds&quot;</span><span class="p">)</span>

plot_field <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>field<span class="p">,</span> name<span class="p">)</span> <span class="p">{</span>
  imagep<span class="p">(</span>field<span class="p">,</span>
         decimate <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
         x<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">1501</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
         y<span class="o">=</span><span class="p">(</span><span class="m">-400</span><span class="o">:</span><span class="m">401</span><span class="p">)</span><span class="o">*</span><span class="m">0.01</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
         ylab<span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span>
         xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span>
         useRaster <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1"># prevents white line glitch</span>
         main<span class="o">=</span>name<span class="p">)</span>
<span class="p">}</span>

<span class="c1"># plot</span>
png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;vort_def_eddy_anisotropy_side_by_side_different_partitioning scales.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">4</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
  plot_field<span class="p">(</span>vort_def_prod1<span class="p">,</span> <span class="s">&quot;Vorticity Deformation 1&quot;</span><span class="p">)</span>
  plot_field<span class="p">(</span>vort_def_prod2<span class="p">,</span> <span class="s">&quot;Vorticity Deformation 2&quot;</span><span class="p">)</span>
  plot_field<span class="p">(</span>vort_def_prod5<span class="p">,</span> <span class="s">&quot;Vorticity Deformation 5&quot;</span><span class="p">)</span>
  plot_field<span class="p">(</span>vort_def_prod10<span class="p">,</span> <span class="s">&quot;Vorticity Deformation 10&quot;</span><span class="p">)</span>
  
  plot_field<span class="p">(</span>eddy_anisotropy1<span class="p">,</span> <span class="s">&quot;Eddy Anisotropy 1&quot;</span><span class="p">)</span>
  plot_field<span class="p">(</span>eddy_anisotropy2<span class="p">,</span> <span class="s">&quot;Eddy Anisotropy 2&quot;</span><span class="p">)</span>
  plot_field<span class="p">(</span>eddy_anisotropy5<span class="p">,</span> <span class="s">&quot;Eddy Anisotropy 5&quot;</span><span class="p">)</span>
  plot_field<span class="p">(</span>eddy_anisotropy10<span class="p">,</span> <span class="s">&quot;Eddy Anisotropy 10&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<p>Notice that some features match better on some specific partitioning scales:
</p><p><a href="wiki/File:Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png.html" class="image"><img alt="Eddy geometry deformation vort def eddy anisotropy side by side different partitioning scales.png" src="images/thumb/4/44/Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png/800px-Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png" decoding="async" width="800" height="400" srcset="images/thumb/4/44/Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png/1200px-Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png 1.5x, images/thumb/4/44/Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png/1600px-Eddy_geometry_deformation_vort_def_eddy_anisotropy_side_by_side_different_partitioning_scales.png 2x" data-file-width="1920" data-file-height="960" /></a>
</p>
<h3><span class="mw-headline" id="Local_patch">Local patch</span></h3>
<p>So, here is the idea. We don't just compare at a point, but instead we compare at a patch of points near that point. Physically, we should expect things to be smooth, so partitioning scale and eddy mixing rate parameters should be similar the closer we are to the center of the patch.
</p><p><br />
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot eddy anisotropy and vorticity deformation vs partitioning scale
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

i <span class="o">=</span> <span class="m">1</span>

<span class="c1"># c(350,300)</span>
<span class="c1"># c(350,400)</span>
origin <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">400</span><span class="p">,</span><span class="m">400</span><span class="p">)</span>

<span class="c1">#points = list(</span>
  <span class="c1">#c(350,304), c(351,304), c(352,304), c(353,304), c(354,304),</span>
  <span class="c1">#c(350,303), c(351,303), c(352,303), c(353,303), c(354,303),</span>
  <span class="c1">#c(350,302), c(351,302), c(352,302), c(353,302), c(354,302),</span>
  <span class="c1">#c(350,301), c(351,301), c(352,301), c(353,301), c(354,301),</span>
  <span class="c1">#c(350,300), c(351,300), c(352,300), c(353,300), c(354,300)</span>
  <span class="c1">#)</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>

  plot<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">),</span> xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.04</span><span class="p">),</span>
       main<span class="o">=</span><span class="s">&quot;Characteristics of fields for different partitioning scales&quot;</span><span class="p">,</span>
       ylab<span class="o">=</span><span class="s">&quot;Vorticity Deformation/Eddy Anisotropy&quot;</span><span class="p">,</span>
       xlab<span class="o">=</span><span class="s">&quot;Partitioning scale&quot;</span><span class="p">)</span>
  legend<span class="p">(</span><span class="s">&quot;topright&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Vorticity Deformation&quot;</span><span class="p">,</span> <span class="s">&quot;Eddy Anisotropy&quot;</span><span class="p">),</span>
         col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">),</span> pch<span class="o">=</span><span class="m">1</span><span class="p">,</span> cex<span class="o">=</span><span class="m">0.8</span><span class="p">)</span>

  <span class="kr">for</span> <span class="p">(</span>dx <span class="kr">in</span> <span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">for</span> <span class="p">(</span>dy <span class="kr">in</span> <span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="p">{</span>
      point <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>origin<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>dx<span class="p">,</span>origin<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span>dy<span class="p">)</span>
      
      vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
      vort_def_prod_vector_x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
      eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
      eddy_anisotropy_vector_x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
      
      samples <span class="o">=</span> <span class="kt">c</span><span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="m">5</span><span class="o">*</span><span class="m">4</span><span class="p">))</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">)</span>
      
      <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> samples<span class="p">)</span> <span class="p">{</span>
        vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
        eddy_anisotropy <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
        
        vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> vort_def_prod<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
        vort_def_prod_vector_x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>vort_def_prod_vector_x<span class="p">,</span> i<span class="p">)</span>
        eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>eddy_anisotropy_vector<span class="p">,</span> eddy_anisotropy<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
        eddy_anisotropy_vector_x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>eddy_anisotropy_vector_x<span class="p">,</span> i<span class="p">)</span>
        <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
      <span class="p">}</span>
      
      points<span class="p">(</span>vort_def_prod_vector_x<span class="p">,</span> vort_def_prod_vector<span class="p">,</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.03</span><span class="p">),</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
      points<span class="p">(</span>eddy_anisotropy_vector_x<span class="p">,</span> eddy_anisotropy_vector<span class="p">,</span> col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot eddy anisotropy vs vorticity deformation for different partitioning scales that seem to make things correlate well.
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

i <span class="o">=</span> <span class="m">1</span>

<span class="c1"># c(350,300)</span>
<span class="c1"># c(350,400)</span>
origin <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">400</span><span class="p">,</span><span class="m">400</span><span class="p">)</span>

<span class="c1">#plot(c(0), xlim=c(0,30), ylim=c(0,0.04))</span>

get_parametrization_for <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
  i <span class="o">&lt;-</span> partitioning_scale
  vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  
  eddy_anisotropy_list <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  <span class="kr">for</span> <span class="p">(</span>dx <span class="kr">in</span> <span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">for</span> <span class="p">(</span>dy <span class="kr">in</span> <span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="p">{</span>
      point <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>origin<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>dx<span class="p">,</span>origin<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span>dy<span class="p">)</span>
      vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      eddy_anisotropy <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      
      vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> vort_def_prod<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>eddy_anisotropy_vector<span class="p">,</span> eddy_anisotropy<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      
      <span class="c1">#points(vort_def_prod_vector_x, vort_def_prod_vector, ylim=c(0,0.03))</span>
      <span class="c1">#points(eddy_anisotropy_vector_x, eddy_anisotropy_vector)</span>
    <span class="p">}</span>
    <span class="kp">print</span><span class="p">(</span>dx<span class="p">)</span>
  <span class="p">}</span>
  
  <span class="kt">list</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> eddy_anisotropy_vector<span class="p">)</span>
<span class="p">}</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">7</span><span class="p">)</span>
plot<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
     xlab<span class="o">=</span><span class="s">&quot;Vorticity Deformation&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Eddy Anisotropy&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Vorticity Deformation as a function of Eddy Anisotropy&quot;</span><span class="p">)</span>
legend<span class="p">(</span><span class="s">&quot;bottomright&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span><span class="p">,</span> <span class="s">&quot;9&quot;</span><span class="p">,</span> <span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="s">&quot;11&quot;</span><span class="p">,</span> <span class="s">&quot;12&quot;</span><span class="p">,</span> <span class="s">&quot;13&quot;</span><span class="p">),</span>
       col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">),</span>
       pch<span class="o">=</span><span class="kt">c</span><span class="p">(</span>    <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>      <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>     <span class="m">3</span><span class="p">,</span>       <span class="m">3</span><span class="p">,</span>      <span class="m">3</span><span class="p">),</span> cex<span class="o">=</span><span class="m">0.8</span><span class="p">)</span>


parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">8</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">9</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">10</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">11</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">12</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">13</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png.html" class="image"><img alt="" src="images/thumb/7/74/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png/360px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png" decoding="async" width="240" height="120" srcset="images/thumb/7/74/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png/540px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png 1.5x, images/thumb/7/74/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png/720px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Eddy anisotropy vs vorticity deformation for several different partitioning scales
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png.html" class="image"><img alt="" src="images/thumb/b/b8/Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png/360px-Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png" decoding="async" width="240" height="120" srcset="images/thumb/b/b8/Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png/540px-Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png 1.5x, images/thumb/b/b8/Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png/720px-Eddy_geometry_deformation_both_fields_in_a_sampling_zone_as_a_function_of_partitioning_scale.png 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Eddy anisotropy and vorticity deformation vs several different partitioning scales
</p>
			</div>
		</div></li>
</ul>
<p>From the plots, we can see that in this patch, optimal partitioning scale is somewhere around 10 and 11 since then the relationship between the fields is linear, as parametrization predicts.
</p><p>It should also be noted that for smaller partitioning scales there is no correlation at all:
</p><p><br />
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot eddy anisotropy and vorticity deformation vs partitioning scale for smaller partitioning scales.
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

i <span class="o">=</span> <span class="m">1</span>

<span class="c1"># c(350,300)</span>
<span class="c1"># c(350,400)</span>
origin <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">400</span><span class="p">,</span><span class="m">400</span><span class="p">)</span>

<span class="c1">#plot(c(0), xlim=c(0,30), ylim=c(0,0.04))</span>

get_parametrization_for <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
  i <span class="o">&lt;-</span> partitioning_scale
  vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  
  eddy_anisotropy_list <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  <span class="kr">for</span> <span class="p">(</span>dx <span class="kr">in</span> <span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">for</span> <span class="p">(</span>dy <span class="kr">in</span> <span class="m">-5</span><span class="o">:</span><span class="m">5</span><span class="p">)</span> <span class="p">{</span>
      point <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>origin<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>dx<span class="p">,</span>origin<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span>dy<span class="p">)</span>
      vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      eddy_anisotropy <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      
      vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> vort_def_prod<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>eddy_anisotropy_vector<span class="p">,</span> eddy_anisotropy<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      
      <span class="c1">#points(vort_def_prod_vector_x, vort_def_prod_vector, ylim=c(0,0.03))</span>
      <span class="c1">#points(eddy_anisotropy_vector_x, eddy_anisotropy_vector)</span>
    <span class="p">}</span>
    <span class="kp">print</span><span class="p">(</span>dx<span class="p">)</span>
  <span class="p">}</span>
  
  <span class="kt">list</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> eddy_anisotropy_vector<span class="p">)</span>
<span class="p">}</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">1</span><span class="p">)</span>
plot<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
     xlab<span class="o">=</span><span class="s">&quot;Vorticity Deformation&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Eddy Anisotropy&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Vorticity Deformation as a function of Eddy Anisotropy&quot;</span><span class="p">)</span>
legend<span class="p">(</span><span class="s">&quot;bottomright&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">,</span> <span class="s">&quot;7&quot;</span><span class="p">),</span>
       col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">),</span>
       pch<span class="o">=</span><span class="kt">c</span><span class="p">(</span>    <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>      <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>     <span class="m">3</span><span class="p">,</span>       <span class="m">3</span><span class="p">,</span>      <span class="m">3</span><span class="p">),</span> cex<span class="o">=</span><span class="m">0.8</span><span class="p">)</span>


parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">2</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">3</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">4</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">5</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">6</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">7</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<p><br />
</p>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales.png.html" class="image"><img alt="" src="images/thumb/0/01/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales.png/360px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_" decoding="async" width="240" height="120" srcset="images/thumb/0/01/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales.png/540px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_ 1.5x, images/thumb/0/01/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales.png/720px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_ 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Eddy anisotropy vs vorticity deformation for several different partitioning scales (small scales)
</p>
			</div>
		</div></li>
</ul>
<p>Alright, we can still start seeing some non-linear correlation starting from around 6-7. But there is definitely no correlation for smaller scales.
</p><p>Now, where does this coherent striped noise come from, even for partitioning scales of 10 and 11? My guess would be that the further we are from the center of the patch, the larger the discrepancy will be between optimal partitioning scale (and eddy mixing rate) for the central point and points away from the central point of the patch.
</p><p>We could test this by coloring the points by their distance from the central point of the patch:
</p><p>TODO
</p><p>Alternatively, we could first identify how far from the single coherent line these points are, and then plot them in the field domain:
</p><p>TODO
</p><p>Objection: Wait, I find this suspicious. Think about it. Our patch is 11x11. And optimal partitioning scale is around 11. This seems awfully suspicious. To make things less biased, we should probably select a smaller patch for smaller partitioning scales (and larger one for larger partitioning scales).
</p><p>Ok, a quick way to get rid of this possible bias is to make sampling region dimensions proportional to partitioning scales. For example, we can set the side length of sampling region to be equal to the partitioning scale (which equals the standard deviation of partitioning Gaussian kernel).
</p>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot eddy anisotropy and vorticity deformation vs partitioning scale for smaller partitioning scales. Debiased version with sampling region proportional to partitioning scale.
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

i <span class="o">=</span> <span class="m">1</span>

<span class="c1"># c(350,300)</span>
<span class="c1"># c(350,400)</span>
origin <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">400</span><span class="p">,</span><span class="m">400</span><span class="p">)</span>

<span class="c1">#plot(c(0), xlim=c(0,30), ylim=c(0,0.04))</span>

get_parametrization_for <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
  i <span class="o">&lt;-</span> partitioning_scale
  vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  
  eddy_anisotropy_list <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  <span class="kr">for</span> <span class="p">(</span>dx <span class="kr">in</span> <span class="o">-</span>partitioning_scale<span class="o">:</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
    <span class="kr">for</span> <span class="p">(</span>dy <span class="kr">in</span> <span class="o">-</span>partitioning_scale<span class="o">:</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
      point <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>origin<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>dx<span class="p">,</span>origin<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span>dy<span class="p">)</span>
      vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      eddy_anisotropy <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      
      vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> vort_def_prod<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>eddy_anisotropy_vector<span class="p">,</span> eddy_anisotropy<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      
      <span class="c1">#points(vort_def_prod_vector_x, vort_def_prod_vector, ylim=c(0,0.03))</span>
      <span class="c1">#points(eddy_anisotropy_vector_x, eddy_anisotropy_vector)</span>
    <span class="p">}</span>
    <span class="kp">print</span><span class="p">(</span>dx<span class="p">)</span>
  <span class="p">}</span>
  
  <span class="kt">list</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> eddy_anisotropy_vector<span class="p">)</span>
<span class="p">}</span>

<span class="c1">#png(file=&quot;eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales.png&quot;,</span>
    <span class="c1">#width=480*2,</span>
    <span class="c1">#height=480,</span>
    <span class="c1">#pointsize=18)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">1</span><span class="p">)</span>
plot<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
     xlab<span class="o">=</span><span class="s">&quot;Vorticity Deformation&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Eddy Anisotropy&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Vorticity Deformation as a function of Eddy Anisotropy&quot;</span><span class="p">)</span>
legend<span class="p">(</span><span class="s">&quot;bottomright&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span><span class="p">,</span> <span class="s">&quot;7&quot;</span><span class="p">),</span>
       col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">),</span>
       pch<span class="o">=</span><span class="kt">c</span><span class="p">(</span>    <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>      <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>     <span class="m">3</span><span class="p">,</span>       <span class="m">3</span><span class="p">,</span>      <span class="m">3</span><span class="p">),</span> cex<span class="o">=</span><span class="m">0.8</span><span class="p">)</span>


parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">2</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">3</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">4</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">5</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">6</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">7</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="c1">#dev.off()</span>
</pre></div>
</td></tr></tbody></table>
<table class="mw-collapsible mw-collapsed" style="width:100%; margin:auto; clear:both; padding:1px; border:1px solid #c0c0c0; background:#fff; float:none">
<tbody><tr>
<th colspan="0" style="padding-left:1em; padding-right:.4em; text-align:center; background-color:#f0f2f5; font-size:88%; color:#000000;">Code to plot eddy anisotropy and vorticity deformation vs partitioning scale for larger partitioning scales. Debiased version with sampling region proportional to partitioning scale.
</th></tr>
<tr>
<td style="text-align:left; font-size:88%;">
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">library</span><span class="p">(</span>GetoptLong<span class="p">)</span>

i <span class="o">=</span> <span class="m">1</span>

<span class="c1"># c(350,300)</span>
<span class="c1"># c(350,400)</span>
origin <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">400</span><span class="p">,</span><span class="m">400</span><span class="p">)</span>

<span class="c1">#plot(c(0), xlim=c(0,30), ylim=c(0,0.04))</span>

get_parametrization_for <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
  i <span class="o">&lt;-</span> partitioning_scale
  vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  
  eddy_anisotropy_list <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">()</span>
  <span class="kr">for</span> <span class="p">(</span>dx <span class="kr">in</span> <span class="o">-</span>partitioning_scale<span class="o">:</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
    <span class="kr">for</span> <span class="p">(</span>dy <span class="kr">in</span> <span class="o">-</span>partitioning_scale<span class="o">:</span>partitioning_scale<span class="p">)</span> <span class="p">{</span>
      point <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>origin<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>dx<span class="p">,</span>origin<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span>dy<span class="p">)</span>
      vort_def_prod <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/vorticity_deformation_product_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      eddy_anisotropy <span class="o">&lt;-</span> <span class="kp">readRDS</span><span class="p">(</span>qq<span class="p">(</span><span class="s">&quot;~/working/spatial_scales/eddy_anisotropy_spatial_mean/@{i}.Rds&quot;</span><span class="p">))</span>
      
      vort_def_prod_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> vort_def_prod<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      eddy_anisotropy_vector <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>eddy_anisotropy_vector<span class="p">,</span> eddy_anisotropy<span class="p">[</span>point<span class="p">[</span><span class="m">1</span><span class="p">],</span>point<span class="p">[</span><span class="m">2</span><span class="p">]])</span>
      
      <span class="c1">#points(vort_def_prod_vector_x, vort_def_prod_vector, ylim=c(0,0.03))</span>
      <span class="c1">#points(eddy_anisotropy_vector_x, eddy_anisotropy_vector)</span>
    <span class="p">}</span>
    <span class="kp">print</span><span class="p">(</span>dx<span class="p">)</span>
  <span class="p">}</span>
  
  <span class="kt">list</span><span class="p">(</span>vort_def_prod_vector<span class="p">,</span> eddy_anisotropy_vector<span class="p">)</span>
<span class="p">}</span>

png<span class="p">(</span>file<span class="o">=</span><span class="s">&quot;eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_debiased.png&quot;</span><span class="p">,</span>
    width<span class="o">=</span><span class="m">480</span><span class="o">*</span><span class="m">2</span><span class="p">,</span>
    height<span class="o">=</span><span class="m">480</span><span class="p">,</span>
    pointsize<span class="o">=</span><span class="m">18</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">7</span><span class="p">)</span>
plot<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
     xlab<span class="o">=</span><span class="s">&quot;Vorticity Deformation&quot;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&quot;Eddy Anisotropy&quot;</span><span class="p">,</span>
     main<span class="o">=</span><span class="s">&quot;Vorticity Deformation as a function of Eddy Anisotropy&quot;</span><span class="p">)</span>
legend<span class="p">(</span><span class="s">&quot;bottomright&quot;</span><span class="p">,</span> legend<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span><span class="p">,</span> <span class="s">&quot;9&quot;</span><span class="p">,</span> <span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="s">&quot;11&quot;</span><span class="p">,</span> <span class="s">&quot;12&quot;</span><span class="p">,</span> <span class="s">&quot;13&quot;</span><span class="p">),</span>
       col<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">),</span>
       pch<span class="o">=</span><span class="kt">c</span><span class="p">(</span>    <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>      <span class="m">1</span><span class="p">,</span>       <span class="m">1</span><span class="p">,</span>     <span class="m">3</span><span class="p">,</span>       <span class="m">3</span><span class="p">,</span>      <span class="m">3</span><span class="p">),</span> cex<span class="o">=</span><span class="m">0.8</span><span class="p">)</span>


parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">8</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
     <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
       <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
     col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">9</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">10</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">11</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">12</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>

parametrization <span class="o">&lt;-</span> get_parametrization_for<span class="p">(</span><span class="m">13</span><span class="p">)</span>
points<span class="p">((</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">1</span><span class="p">]))),</span>
       <span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))</span><span class="o">/</span>
         <span class="p">(</span><span class="kp">max</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">-</span><span class="kp">min</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>parametrization<span class="p">[</span><span class="m">2</span><span class="p">])))),</span>
       col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">3</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<ul class="gallery mw-gallery-packed">
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales_debiased.png.html" class="image"><img alt="" src="images/thumb/a/a7/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales_debiased.png/360px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_part" decoding="async" width="240" height="120" srcset="images/thumb/a/a7/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales_debiased.png/540px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_part 1.5x, images/thumb/a/a7/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_small_scales_debiased.png/720px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_part 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Eddy anisotropy and vorticity deformation vs several different partitioning scales (small scales, debiased)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 242px"><div style="width: 242px">
			<div class="thumb" style="width: 240px;"><div style="margin:0px auto;"><a href="wiki/File:Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_debiased.png.html" class="image"><img alt="" src="images/thumb/0/0d/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_debiased.png/360px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scal" decoding="async" width="240" height="120" srcset="images/thumb/0/0d/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_debiased.png/540px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scal 1.5x, images/thumb/0/0d/Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scales_debiased.png/720px-Eddy_geometry_deformation_eddy_ani_as_function_of_vort_def_linear_several_partitioning_scal 2x" data-file-width="960" data-file-height="480" /></a></div></div>
			<div class="gallerytext">
<p>Eddy anisotropy and vorticity deformation vs several different partitioning scales (large scales, debiased)
</p>
			</div>
		</div></li>
</ul>
<p>As we can see from the plots above, we get similar results when accounted for a possible bias that could come from the size of sampling patch.
</p><p>And we also see again that the relationship between the fields is most linear when partitioning scale is about 10. Let's study this case in detail, and also let's color the points by distance from the center of the sampling patch. I would expect that the points that are furthest from the center perform the worse.
</p><p>TODO: have a weighted correlation?
</p><p>TODO: figure out where squiggly lines come from
</p><p>TODO: add a spatial picture of plots above. I.e. plot the actual field instead of just scatter plot. We should be able to visually confirm that fields start looking more and more similar for the optimal partitioning scale.
</p><p>TODO: eddy mixing rate should be a function of partition scale. So we can group all patches with the same partition scale together to do a generic fit. A benefit of this is that errors will probably be more gaussian in this case.
</p>
<h2><span class="mw-headline" id="TODO">TODO</span></h2>
<p>FIGURE 1
[L for fully resolved flow with streamfunction (mean and instantaneous) superimposed]
Figure 1: The eddy anisotropy of the idealized WBC that is the target of the parameterization based on the large-scale flow deformation.
</p><p>FIGURE 2
[4x3 panel showing KE?; deformation?; parameterized L; some metric of match to eddy L/required mixing rate? for sigma = 20, 40 and 200 km]
Figure 2: Character of the large-scale flow and its performance in predicting the eddy anisotropy via the deformation-based parameterization as a function of the partition scale.
</p><p>FIGURE 3
[Diagnostics of KE? deformation? In large vs small scale  flow as a function of partition scale on the x-axis in efforts to argue there is no obvious choice for the partition scale]
-- Maybe show that at different scales, different features are parametrized better?
</p><p>FIGURE 4
[Mean optimal sigma and mixing rate from 998 iterations if both are allowed to vary spatially; paramterized L from optimal fit and mean(relative error)]
TO DO: Get mean &amp; stds of 998 fits from Danil
</p><p>FIGURE 5
[More analysis of performance of the parameterization: scatter plot showing actual L on x, parameterized L on y coloured by mixing rate? partition scale?]
TO DO: Get mean &amp; stds of 998 fits from Danil
</p><p>FIGURE 6?
[Something speculative about how to “guess” the sigma from diagnoses of eddy size: show EKE is not a good predictor but loop calculation can capture some gross features like minimia in size on flanks of jet and enhancement at EKE maximum?; show best fit separation scale vs eddy size as field plots?  Scaltter plots?
</p><p><br />
</p>
<ul><li>It seems that field is not zoomed in on the region of interest (as in for example, <sup id="cite_ref-2" class="reference"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#cite_note-2">&#91;2&#93;</a></sup>). Need to re-scale so that the things are consistent. But it's good that we have the sponge regions since that allows us to do convolutions more easily.<div class="mw-references-wrap"><ol class="references"></ol></div></li></ul>
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#cite_ref-1">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="http://www.stephaniewaterman.ca/Work/Documents/Presentations/2018/EnergyTransfers2018_Waterman.pdf">http://www.stephaniewaterman.ca/Work/Documents/Presentations/2018/EnergyTransfers2018_Waterman.pdf</a> , slide 20</span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FMotivation%252F1&amp;printable=yes.html#cite_ref-2">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://ams.confex.com/ams/22FLUID/meetingapp.cgi/Paper/360110">https://ams.confex.com/ams/22FLUID/meetingapp.cgi/Paper/360110</a></span>
</li>

<!-- 
NewPP limit report
Cached time: 20201215164847
Cache expiry: 86400
Dynamic content: false
Complications: []
[SMW] In‐text annotation parser time: 0 seconds
CPU time usage: 0.566 seconds
Real time usage: 9.633 seconds
Preprocessor visited node count: 1130/1000000
Preprocessor generated node count: 0/1000000
Post‐expand include size: 12687/2097152 bytes
Template argument size: 3318/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 215740/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 8990.479      1 -total
 98.50% 8855.940     27 Template:Collapse
-->

<!-- Saved in parser cache with key my_wiki:pcache:idhash:26-0!canonical!math=5 and timestamp 20201215164838 and revision id 604
 -->
</div></div>
		
		<div class="printfooter">Retrieved from "<a dir="ltr" href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;oldid=604.html">https://wiki.nya.pink/index.php?title=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields&amp;oldid=604</a>"</div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="wiki/Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="wiki/Category:Mesoscale_ocean_eddies.html" title="Category:Mesoscale ocean eddies">Mesoscale ocean eddies</a></li></ul></div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="./index.php%3Ftitle=Special:UserLogin&amp;returnto=Research:Evaluating+deformation-based+paramatrization+of+ocean+mesoscale+eddies+using+eddy+geometry+approach%252FOverview+of+relevant+fields&amp;returntoquery=printable=yes.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="wiki/Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://wiki.nya.pink/index.php?title=Talk:Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<ul class="menu">
													</ul>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="wiki/Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;action=edit.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;action=history.html" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<ul class="menu">
													</ul>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://wiki.nya.pink/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Lab Journal Wiki" title="Search Lab Journal Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="robots.txt.html" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage-description"><a href="robots.txt.html" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="https://wiki.nya.pink/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="wiki/Special:Random.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help-mediawiki"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">Help about MediaWiki</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="wiki/Special:WhatLinksHere/Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="https://wiki.nya.pink/wiki/Special:RecentChangesLinked/Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach/Overview_of_relevant_fields" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="wiki/Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;oldid=604.html" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="./index.php%3Ftitle=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;action=info.html" title="More information about this page">Page information</a></li><li id="t-cite"><a href="./index.php%3Ftitle=Special:CiteThisPage&amp;page=Research:Evaluating_deformation-based_paramatrization_of_ocean_mesoscale_eddies_using_eddy_geometry_approach%252FOverview_of_relevant_fields&amp;id=604.html" title="Information on how to cite this page">Cite this page</a></li><li id="t-smwbrowselink"><a href="wiki/Special:Browse/:Research:Evaluating-5Fdeformation-2Dbased-5Fparamatrization-5Fof-5Focean-5Fmesoscale-5Feddies-5Fusing-5Feddy-5Fgeometry-5Fapproach-2FOverview-5Fof-5Frelevant-5Ffields.html" rel="search">Browse properties</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 5 September 2020, at 08:21.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="https://wiki.nya.pink/wiki/Lab_Journal_Wiki:Privacy_policy" title="Lab Journal Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="https://wiki.nya.pink/wiki/Lab_Journal_Wiki:About" title="Lab Journal Wiki:About">About Lab Journal Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="https://wiki.nya.pink/wiki/Lab_Journal_Wiki:General_disclaimer" title="Lab Journal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a><a href="https://www.semantic-mediawiki.org/wiki/Semantic_MediaWiki"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAMAAABUFvrSAAACJVBMVEXe3t62trbLy8vGxsbAwMDX19e6urqsrKxHcEzQ0NC2tratra2oqKixsbHd3eDFxcXe3t7U1NTa2trX19fQ0NDV1dWNjY2dnZ2UlJSUlJTS0tKUlJSWlpbR0dGenp79/f38/Pz+/v7t7e3v7+/u7u7s7Oz19fX29vb6+vr7+/vz8/Pz8/P4+fnw8PD39/gWTq/09PX6+vktX7b/sg8XT7F6mc/f5OwhVrNvkMthhsfT2+j7rQ/M1eZqjcmFotPs7e9Cb722xuFResK/zOObstnu7/Grvd3M1+mNqNY6aLoaUbEaUbZWfsTk6fE2Zrnp7O8bTq0kWLQuYcpcg8Xh5/Byk83a4eukud1/nM+6yeQkWcGwwuDxnRQyYrigttvI0+gpW7XGyttLdsBni8geVLo0Z9XlkCPb4u+QqtcfVLLo7PNHcr73phFGX6HsmBnpkxg6bNwnXcbX3er19vnr7/SVrdhuhLl+j70vVqY6Xqv0oxJVcbQhV76DjKTz9ffQ2evE0OZAbbzu7/PS1uFufrDnrGgpSZjy8/SQnMFddrKuekXSiCsgTKRaaZHejy9yang3VptNaqspWbnmliy3j2/m6OzT3e7x8fL4+v3p6uwaN2re0cifqLiLiZWYhYGYb0xXYn+5g0xwiMKYpc2BcHZmW2srRXpGWIhecKfilz4+WID2+PyosMywqbGqss1aVnLZq33p1sGklZqrp7dkfr7CpY9yg59Ud6QZAAAAH3RSTlPfBN/f39/f2wDf39vV3/7N2rrEz5D5c8ONuHaPuXXDImoxqwAABO1JREFUSMe1kQdz01gQgBXaBS4w9OtHwMFSdPKTUNxkW+61xN2Je4tLHJNOGukkAUINJTzaUIbO9fr7TpLtS44DZiC5b6Sn3dW+TysJaWz4cv9eZFPZu/+bhkakYR88WqP59u3vjxzdDCT7GpCD4qNH3sEGzOhB5MCR/4PmA8j25uZ33t0A23lxff5hZTIzOrz2Ph8qK936l7i1tT7hk8DAoHNsbeLWKjPdQcZ+qvX9tHMNXca1XBDXHtL6x2Bh0HWtuXUo8oTgC1gVpcdsdpew92PUYtjwzFq+E9mJYfXxx1x5l2/l5Vhy0DW6TuyQCZcR2hnswXJM0h+203471u5WKMIE5mDpspIIO8sZTMZiIbczY6+JCaI+/sJZ38qjP28+nQjkx/mcqGJ26rW3iKg/fYphCL1jNk5WbqXI0nBnu00RJ2j9bNRp6MmFS0SYIXLuUlQ5w22qizHr5MTyy2u/3XxVvHHlwtWVa/xTCQIIlEaMzrgswzA5P9BrAciYASqNoiNdjL8b0GYAHN3AGAEgzPSQc9UtYCeyBQAMO2G9PhhzXfp9qdifSCT6Lj788QQnrvWEuNPI2um0LW0D+m4A6E4AnIZOeq7ksQuJvi6eUXRW+8EWXsxNPhkYGJiSXr7Rd1qtVp9MXHkgIurzAkdFxjrj7cmKbN4K5v8RGxT2sJMTpwBflNHhUJgBdoUylzy3TuwIDBRi0hf9p9VtbW3qk30X7q2Je1IybZq7mLVWFKTSADXPoqi9AzVorda0kKTS6KkRbSgaR1GT1h5CObYiW1GU27yc5z6F9Fn/yTYedeLi9AIA6AbgxGIxAMPZcZeUHH9cFavVfY97FaNA/DbazRZVV89/61at2BTlg1JXiFtrYoBmRyd7p6/UP0XxaSDmy4pt0jmuh8qx6wQ2MmRz18TaJCUWO9xisUVhMMsoZZDiGHLLuXUbso2iatP/1HvhYu3n3bh6Pe/LUjZSj1NUJ8lSlNwahRRlMRjmyFDICikVn8+SacomdbZTVj+0mQSxweS1WqpiHK/Ncubs858f9idOJ/qKS1cv+RbFuIbMmHEvTbO4QeF25CxyD62nSbmJ1MUzRrpiwR0RPBJMpnCGxWVGXBn8TkarNGQHjuPrxOeWY4GY9FmxWHy19Gvv+ayYF6f8oYi7i8U93bjFkYokvbhWEFu8Og2ZxrUe3NMpc3vLhqqYpVV4XbwDQkpgoVwYKOR9N5d+eXB5vJevQA0pD7oVqi4WOj16vX6EYSA08WKvyeOZJw1cQ6rsnXOa/RYoM0Kls0zLuVoHhHAHL8YFXkwVCoE8uXhvMVCY8mW5Ci8eKkcgJ9azOl0UajNDFiUpj5JeloEqTgwd/iCUJP0sFMSejkpO96b4zl1fPuYiyd6Vs4GBmHSsJoYmLy/WeBTlis5rlJYrgjhe1s+XOXGEtHJOMl4VB2EHLauKdyG7JBLIc//uslRKkhOrcGJqyiU9z5UkOpVOwiGXSyQizRAfqlRc7Y5KJFnV6FReiWSV7xAWeQd/SOSq6qY18eVHq4vjlyazEJ73ScmJPVxJVKdF9MFwYpFIEL+ehvDOcSH8YXRsAa4XfwS7kd0tLfw7Sp7fl7xJywbYjTTVotfTb+849lEcb0K+2lMN/5o+tons+Rxp+PrQ8U3n0BcNSGPj4W+bPuX5ZLNo+uxwY+PfoLJHX1KXgyMAAAAASUVORK5CYII=" alt="Powered by Semantic MediaWiki" class="smw-footer" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"smw":{"limitreport-intext-parsertime":0},"limitreport":{"cputime":"0.566","walltime":"9.633","ppvisitednodes":{"value":1130,"limit":1000000},"ppgeneratednodes":{"value":0,"limit":1000000},"postexpandincludesize":{"value":12687,"limit":2097152},"templateargumentsize":{"value":3318,"limit":2097152},"expansiondepth":{"value":4,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":215740,"limit":5000000},"timingprofile":["100.00% 8990.479      1 -total"," 98.50% 8855.940     27 Template:Collapse"]},"cachereport":{"timestamp":"20201215164847","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":99});});</script>
</body>
</html>
