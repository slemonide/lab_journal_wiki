<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing - Lab Journal Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing","wgTitle":"Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing","wgCurRevisionId":303,"wgRevisionId":303,"wgArticleId":27,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Matrix completion"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],
"wgRelevantPageName":"Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing","wgRelevantArticleId":27,"wgRequestId":"8b82e9d05c4660cdb8588898","wgCSPNonce":!1,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgMediaViewerOnClick":!0,"wgMediaViewerEnabledByDefault":!0};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","ext.cite.styles":"ready","ext.math.styles":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.toc.styles":"ready","ext.scite.styles":"ready","ext.smw.style":"ready","ext.smw.tooltip.styles":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"};RLPAGEMODULES=["ext.smw.style","ext.smw.tooltips","ext.cite.ux-enhancements","ext.math.scripts","ext.smw.table.styles","smw.factbox","site",
"mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","ext.scite.styles","ext.scite.tooltip","skins.vector.js"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.tokens@tffin",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="load.php%3Flang=en&amp;modules=ext.cite.styles|ext.math.styles|mediawiki.legacy.commonPrint,shared|mediawiki.skinning.interface|mediawiki.toc.styles|skins.vector.styles&amp;only=styles&amp;printable=1&amp;skin=vector.css"/>
<link rel="stylesheet" href="load.php%3Flang=en&amp;modules=ext.scite.styles|ext.smw.style|ext.smw.tooltip.styles&amp;only=styles&amp;printable=1&amp;skin=vector.css"/>
<script async="" src="load.php%3Flang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.34.2"/>
<meta name="robots" content="noindex,follow"/>
<link rel="alternate" type="application/rdf+xml" title="Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing" href="./index.php%3Ftitle=Special:ExportRDF%252FResearch:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;xmlmime=rdf"/>
<link rel="shortcut icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Lab Journal Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php%3Faction=rsd"/>
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Research_Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing_Hastie_2014_softImpute-ALS_debiasing rootpage-Research_Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing skin-vector action-view">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From Lab Journal Wiki</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="wiki/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing.html" title="Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing">Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Previous_work"><span class="tocnumber">1</span> <span class="toctext">Previous work</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Definitions"><span class="tocnumber">2</span> <span class="toctext">Definitions</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Optimization_problems"><span class="tocnumber">3</span> <span class="toctext">Optimization problems</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#softImpute-ALS"><span class="tocnumber">4</span> <span class="toctext">softImpute-ALS</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Surrogate_functions"><span class="tocnumber">4.1</span> <span class="toctext">Surrogate functions</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Alternative_subspace_minimization_scheme"><span class="tocnumber">4.2</span> <span class="toctext">Alternative subspace minimization scheme</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Debiased_softImpute-ALS"><span class="tocnumber">5</span> <span class="toctext">Debiased softImpute-ALS</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Surrogate_functions_2"><span class="tocnumber">5.1</span> <span class="toctext">Surrogate functions</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Important_properties_of_surrogate_functions"><span class="tocnumber">5.1.1</span> <span class="toctext">Important properties of surrogate functions</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Algorithm"><span class="tocnumber">5.2</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Loewner_order_.28bounds_on_eigenvalues.29"><span class="tocnumber">6</span> <span class="toctext">Loewner order (bounds on eigenvalues)</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Splitting_the_projection_operator"><span class="tocnumber">7</span> <span class="toctext">Splitting the projection operator</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Reiterating_on_the_function_we_want_to_minimize"><span class="tocnumber">7.1</span> <span class="toctext">Reiterating on the function we want to minimize</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#Continuation"><span class="tocnumber">8</span> <span class="toctext">Continuation</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#References"><span class="tocnumber">9</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Previous_work">Previous work</span></h2>
<p>I am mostly using the algorithm described in Hastie et al. <span id="scite-ref-8834f78b18f26ea5ac7fad69d0836d6c-1-a" class="scite-citeref-number" data-reference="hastie2014matrix"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#scite-8834f78b18f26ea5ac7fad69d0836d6c">1</a></span>. There are two other papers (<span id="scite-ref-0d1b702bb5c44f8a054685502e2f75b9-2-a" class="scite-citeref-number" data-reference="jain2012lowrank"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#scite-0d1b702bb5c44f8a054685502e2f75b9">2</a></span> and <span id="scite-ref-4da4ae5e56b28579e986b1e584171aa3-3-a" class="scite-citeref-number" data-reference="hardt2013understanding"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#scite-4da4ae5e56b28579e986b1e584171aa3">3</a></span>) in which the problem is similar enough so that it can be debiased in a similar fashion. The reason to study them is that they provide different convergence guarantees each. For now, can stick to Hastie et al. algorithm.
</p><p>TODO: add links: <sup id="cite_ref-1" class="reference"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#cite_note-1">&#91;1&#93;</a></sup>, <sup id="cite_ref-2" class="reference"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#cite_note-2">&#91;2&#93;</a></sup>.
</p>
<h2><span class="mw-headline" id="Definitions">Definitions</span></h2>
<p>I will use notation similar to Hastie et al. paper to minimize confusion.
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }(X)_{ij}=X_{ij}{\text{ if }}{ij}\in \Omega ,0{\text{ otherwise}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <msub>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;if&#xA0;</mtext>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>i</mi>
          <mi>j</mi>
        </mrow>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
        <mo>,</mo>
        <mn>0</mn>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;otherwise</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }(X)_{ij}=X_{ij}{\text{ if }}{ij}\in \Omega ,0{\text{ otherwise}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/db51d18f87f84d1667b62681bce2edac7704e85a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:35.831ex; height:3.009ex;" alt="{\displaystyle P_{\Omega }(X)_{ij}=X_{ij}{\text{ if }}{ij}\in \Omega ,0{\text{ otherwise}}}"/></span></dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }(X)_{ij}=X_{ij}{\text{ if }}{ij}\notin \Omega ,0{\text{ otherwise}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <msub>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;if&#xA0;</mtext>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>i</mi>
          <mi>j</mi>
        </mrow>
        <mo>&#x2209;<!-- ∉ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
        <mo>,</mo>
        <mn>0</mn>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;otherwise</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }(X)_{ij}=X_{ij}{\text{ if }}{ij}\notin \Omega ,0{\text{ otherwise}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/22ce4f4b9b664e6cfe912c53c1a5bf774580eb3b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:35.831ex; height:3.009ex;" alt="{\displaystyle P_{\Omega }(X)_{ij}=X_{ij}{\text{ if }}{ij}\notin \Omega ,0{\text{ otherwise}}}"/></span></dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X{\text{ is the original data matrix}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>X</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;is the original data matrix</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X{\text{ is the original data matrix}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/55f22e739db8803d80de626c614f031e90687179" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:28.619ex; height:2.509ex;" alt="{\displaystyle X{\text{ is the original data matrix}}}"/></span></dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle M{\text{ and }}A,B{\text{ are optimization variables}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>M</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;and&#xA0;</mtext>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;are optimization variables</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle M{\text{ and }}A,B{\text{ are optimization variables}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bb71e5d58a4f4e250d8c37be3fa66f004f3ef819" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:38.53ex; height:2.509ex;" alt="{\displaystyle M{\text{ and }}A,B{\text{ are optimization variables}}}"/></span></dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ||X||_{F}{\text{ is the Frobenious norm of matrix X}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>X</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;is the Frobenious norm of matrix X</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ||X||_{F}{\text{ is the Frobenious norm of matrix X}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7451cc31a3f5ec413060a4e71a82636d17b2966c" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:41.824ex; height:2.843ex;" alt="{\displaystyle ||X||_{F}{\text{ is the Frobenious norm of matrix X}}}"/></span></dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ||X||_{*}{\text{ is the nuclear norm of matrix X}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>X</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>&#xA0;is the nuclear norm of matrix X</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ||X||_{*}{\text{ is the nuclear norm of matrix X}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e81f2ca9e6d558cd427e12dfeb85d7678e2c5ae4" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.607ex; margin-bottom: -0.231ex; width:37.558ex; height:2.843ex;" alt="{\displaystyle ||X||_{*}{\text{ is the nuclear norm of matrix X}}}"/></span></dd></dl>
<h2><span class="mw-headline" id="Optimization_problems">Optimization problems</span></h2>
<p>Hastie et al. essentially try to solve a convex optimization problem Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:convex-sing-val-min" title="Equation 1" class="extermal text" rel="nofollow">1</a> by instead looking for a solution for a non-convex optimization problem Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:non-convex-frob-min" title="Equation 2" class="extermal text" rel="nofollow">2</a>. It turns out that these two problems actually have the same solution, as is shown in their paper.
</p>
<dl><dd><div class="crossref-block" id="label-eq:convex-sing-val-min"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}&amp;{\underset {M}{\text{minimize}}}&amp;&amp;H(M):={\frac {1}{2}}||P_{\Omega }(X-M)|_{F}^{2}+\lambda ||M||_{*}\end{aligned}}\quad {\text{(convex)}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd />
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <munder>
                    <mtext>minimize</mtext>
                    <mi>M</mi>
                  </munder>
                </mrow>
              </mtd>
              <mtd />
              <mtd>
                <mi>H</mi>
                <mo stretchy="false">(</mo>
                <mi>M</mi>
                <mo stretchy="false">)</mo>
                <mo>:=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>X</mi>
                <mo>&#x2212;<!-- − --></mo>
                <mi>M</mi>
                <mo stretchy="false">)</mo>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mi>&#x03BB;<!-- λ --></mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>M</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
        <mspace width="1em" />
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>(convex)</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}&amp;{\underset {M}{\text{minimize}}}&amp;&amp;H(M):={\frac {1}{2}}||P_{\Omega }(X-M)|_{F}^{2}+\lambda ||M||_{*}\end{aligned}}\quad {\text{(convex)}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/522908c2385347c067a3f9aef9aa167d1c7ea05c" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.866ex; margin-bottom: -0.305ex; width:63.398ex; height:5.509ex;" alt="{\displaystyle {\begin{aligned}&amp;{\underset {M}{\text{minimize}}}&amp;&amp;H(M):={\frac {1}{2}}||P_{\Omega }(X-M)|_{F}^{2}+\lambda ||M||_{*}\end{aligned}}\quad {\text{(convex)}}}"/></span> <span class="cross-id">(1)</span></span></div></dd></dl>
<dl><dd><div class="crossref-block" id="label-eq:non-convex-frob-min"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}&amp;{\underset {A,B}{\text{minimize}}}&amp;&amp;F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}\quad {\text{(non-convex)}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd />
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <munder>
                    <mtext>minimize</mtext>
                    <mrow>
                      <mi>A</mi>
                      <mo>,</mo>
                      <mi>B</mi>
                    </mrow>
                  </munder>
                </mrow>
              </mtd>
              <mtd />
              <mtd>
                <mi>F</mi>
                <mo stretchy="false">(</mo>
                <mi>A</mi>
                <mo>,</mo>
                <mi>B</mi>
                <mo stretchy="false">)</mo>
                <mo>:=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>X</mi>
                <mo>&#x2212;<!-- − --></mo>
                <mi>A</mi>
                <msup>
                  <mi>B</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>A</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>B</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
        <mspace width="1em" />
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>(non-convex)</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}&amp;{\underset {A,B}{\text{minimize}}}&amp;&amp;F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}\quad {\text{(non-convex)}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8e91beab368f79f66a78c8464277cf76df8c4c7d" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.085ex; margin-bottom: -0.253ex; width:84.189ex; height:5.843ex;" alt="{\displaystyle {\begin{aligned}&amp;{\underset {A,B}{\text{minimize}}}&amp;&amp;F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}\quad {\text{(non-convex)}}}"/></span> <span class="cross-id">(2)</span></span></div></dd></dl>
<h2><span class="mw-headline" id="softImpute-ALS">softImpute-ALS</span></h2>
<h3><span class="mw-headline" id="Surrogate_functions">Surrogate functions</span></h3>
<p>Hastie et al. define majorizers Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:Q_A_def" title="Equation 3" class="extermal text" rel="nofollow">3</a> and Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:Q_B_def" title="Equation 4" class="extermal text" rel="nofollow">4</a>. Furthermore, they show that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}(Z_{1}|A,B)\geq F(Z_{1},B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}(Z_{1}|A,B)\geq F(Z_{1},B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/abc09e351b70279499431076ef9e308e40d9c7d0" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:25.03ex; height:2.843ex;" alt="{\displaystyle Q_{A}(Z_{1}|A,B)\geq F(Z_{1},B)}"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}(Z_{2}|A,B)\geq F(A,Z_{2})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}(Z_{2}|A,B)\geq F(A,Z_{2})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/060aca4d48c8117219590dcc52f12f6a17160bf7" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:25.024ex; height:2.843ex;" alt="{\displaystyle Q_{B}(Z_{2}|A,B)\geq F(A,Z_{2})}"/></span>.
</p>
<dl><dd><div class="crossref-block" id="label-eq:Q_A_def"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}Q_{A}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msub>
                  <mi>Q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>A</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>A</mi>
                <mo>,</mo>
                <mi>B</mi>
                <mo stretchy="false">)</mo>
                <mo>:=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>X</mi>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>1</mn>
                  </mrow>
                </msub>
                <msup>
                  <mi>B</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <msubsup>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>A</mi>
                <msup>
                  <mi>B</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msup>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>1</mn>
                  </mrow>
                </msub>
                <msup>
                  <mi>B</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>B</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}Q_{A}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9b3dadc3da44eec4a8eec7a61812f99d0af6c4f8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.81ex; margin-bottom: -0.194ex; width:82.908ex; height:5.176ex;" alt="{\displaystyle {\begin{aligned}Q_{A}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}}"/></span> <span class="cross-id">(3)</span></span></div></dd></dl>
<dl><dd><div class="crossref-block" id="label-eq:Q_B_def"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}Q_{B}(Z_{2}|A,B):={\frac {1}{2}}||P_{\Omega }(X-AZ_{2}^{T})+P_{\Omega }^{\bot }(AB^{T}-AZ_{2}^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||Z_{2}||_{F}^{2}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msub>
                  <mi>Q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>B</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>A</mi>
                <mo>,</mo>
                <mi>B</mi>
                <mo stretchy="false">)</mo>
                <mo>:=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>X</mi>
                <mo>&#x2212;<!-- − --></mo>
                <mi>A</mi>
                <msubsup>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msubsup>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <msubsup>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>A</mi>
                <msup>
                  <mi>B</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msup>
                <mo>&#x2212;<!-- − --></mo>
                <mi>A</mi>
                <msubsup>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msubsup>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>A</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}Q_{B}(Z_{2}|A,B):={\frac {1}{2}}||P_{\Omega }(X-AZ_{2}^{T})+P_{\Omega }^{\bot }(AB^{T}-AZ_{2}^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||Z_{2}||_{F}^{2}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b6f6266ab199ebf42f26a420b7e88172049cad21" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.81ex; margin-bottom: -0.194ex; width:80.993ex; height:5.176ex;" alt="{\displaystyle {\begin{aligned}Q_{B}(Z_{2}|A,B):={\frac {1}{2}}||P_{\Omega }(X-AZ_{2}^{T})+P_{\Omega }^{\bot }(AB^{T}-AZ_{2}^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||Z_{2}||_{F}^{2}\end{aligned}}}"/></span> <span class="cross-id">(4)</span></span></div></dd></dl>
<p>It's a good idea to compare these two with
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>F</mi>
                <mo stretchy="false">(</mo>
                <mi>A</mi>
                <mo>,</mo>
                <mi>B</mi>
                <mo stretchy="false">)</mo>
                <mo>:=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mi>P</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>X</mi>
                <mo>&#x2212;<!-- − --></mo>
                <mi>A</mi>
                <msup>
                  <mi>B</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>T</mi>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>A</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03BB;<!-- λ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>B</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>F</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dd44699dae6bca42f30f7ced2e143241ed9e2430" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.81ex; margin-bottom: -0.194ex; width:54.746ex; height:5.176ex;" alt="{\displaystyle {\begin{aligned}F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}\end{aligned}}}"/></span>
</p><p>Since it's central to their proof, we should also re-state proof of connection between these surrogate functions and the objective function of the non-convex problem.
</p><p><b>Lemma</b>: <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}(Z_{1}|A,B)\geq F(Z_{1},B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}(Z_{1}|A,B)\geq F(Z_{1},B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/abc09e351b70279499431076ef9e308e40d9c7d0" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:25.03ex; height:2.843ex;" alt="{\displaystyle Q_{A}(Z_{1}|A,B)\geq F(Z_{1},B)}"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}(Z_{2}|A,B)\geq F(A,Z_{2})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}(Z_{2}|A,B)\geq F(A,Z_{2})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/060aca4d48c8117219590dcc52f12f6a17160bf7" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:25.024ex; height:2.843ex;" alt="{\displaystyle Q_{B}(Z_{2}|A,B)\geq F(A,Z_{2})}"/></span>
</p><p><b>Proof</b>:
Consider the function <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle g(AB^{T}):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>g</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle g(AB^{T}):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d9105a532eeff3bc3f352c6bd9726bb1073f0c22" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:32.053ex; height:5.176ex;" alt="{\displaystyle g(AB^{T}):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}}"/></span> which is the training error as a function of the outer-product <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z=AB^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Z</mi>
        <mo>=</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z=AB^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3988dd94b8b976471925c424d81323a9b7f0763e" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:9.675ex; height:2.676ex;" alt="{\displaystyle Z=AB^{T}}"/></span>, and observe that for any <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z,{\hat {Z}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Z</mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>Z</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z,{\hat {Z}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bca866872def49986d962b62f434b67f8315da84" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:4.395ex; height:3.176ex;" alt="{\displaystyle Z,{\hat {Z}}}"/></span> we have:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle g(Z)\leq {\frac {1}{2}}||P_{\Omega }(X-Z)+P_{\Omega }^{\bot }({\hat {Z}}-Z)||_{F}^{2}={\frac {1}{2}}||(P_{\Omega }(X)+P_{\Omega }^{\bot }({\hat {Z}}))-Z||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>g</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2264;<!-- ≤ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>Z</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
        </mrow>
        <mo>&#x2212;<!-- − --></mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>Z</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- − --></mo>
        <mi>Z</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle g(Z)\leq {\frac {1}{2}}||P_{\Omega }(X-Z)+P_{\Omega }^{\bot }({\hat {Z}}-Z)||_{F}^{2}={\frac {1}{2}}||(P_{\Omega }(X)+P_{\Omega }^{\bot }({\hat {Z}}))-Z||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/feebf7528d2615b43329ea6ca78e7b8aa2c801f2" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:70.998ex; height:5.176ex;" alt="{\displaystyle g(Z)\leq {\frac {1}{2}}||P_{\Omega }(X-Z)+P_{\Omega }^{\bot }({\hat {Z}}-Z)||_{F}^{2}={\frac {1}{2}}||(P_{\Omega }(X)+P_{\Omega }^{\bot }({\hat {Z}}))-Z||_{F}^{2}}"/></span>
</p><p>The equality is achieved if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z={\hat {Z}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Z</mi>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>Z</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z={\hat {Z}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b955c0d69f6a5144379241d1f285da7c8e5a6bbf" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.459ex; height:2.843ex;" alt="{\displaystyle Z={\hat {Z}}}"/></span>
</p><p>Also notice that essentially it doesn't matter at all what we put in the perpendicular part of the sum. I.e. we can take any arbitrary matrix <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle H}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>H</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle H}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/75a9edddcca2f782014371f75dca39d7e13a9c1b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:2.064ex; height:2.176ex;" alt="{\displaystyle H}"/></span> and add <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }^{\bot }(H)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>H</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }^{\bot }(H)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b1f62940132367428ae542310296cea6a8612f59" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:7.205ex; height:3.176ex;" alt="{\displaystyle P_{\Omega }^{\bot }(H)}"/></span> inside <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle g}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>g</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle g}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d3556280e66fe2c0d0140df20935a6f057381d77" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:1.116ex; height:2.009ex;" alt="{\displaystyle g}"/></span> without changing the outcome of this lemma. This will be useful later.
</p><p><b>QED</b>
</p>
<h3><span class="mw-headline" id="Alternative_subspace_minimization_scheme">Alternative subspace minimization scheme</span></h3>
<p>To minimize problem Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:non-convex-frob-min" title="Equation 2" class="extermal text" rel="nofollow">2</a> they then propose an alternative minimization scheme where they repeatedly fix $A$ or $B$ and optimize for the other variable. They call the algorithm softImpute-ALS. This algorithm, in the form most convenient for theoretical analysis is given in Algorithm Definition <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-alg:softImpute-ALS" title="Definition 1" class="extermal text" rel="nofollow">1</a>.
</p>
<div class="crossref-block" id="label-alg:softImpute-ALS"><span class="crossref-content"><b>Algorithm (softImpute-ALS)</b>:
<ul><li><b>Inputs:</b> Data matrix <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>X</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/68baa052181f707c662844a465bfeeb135e82bab" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.98ex; height:2.176ex;" alt="{\displaystyle X}"/></span>, initial iterates <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A_{0}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>A</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A_{0}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7c98dbd929292d464de6942e95db306b8b8a6fca" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:2.797ex; height:2.509ex;" alt="{\displaystyle A_{0}}"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B_{0}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B_{0}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/03a3f39a56ba486e7c6ec89b99f5ae2a21fa75b6" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:2.818ex; height:2.509ex;" alt="{\displaystyle B_{0}}"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k=0}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k=0}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6307c8a99dad7d0bcb712352ae0a748bd99a038b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.472ex; height:2.176ex;" alt="{\displaystyle k=0}"/></span>.</li>
<li><b>Outputs:</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle (A^{*},B^{*})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo stretchy="false">(</mo>
        <msup>
          <mi>A</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>,</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle (A^{*},B^{*})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0e22de1c9cc194af94454a8c0337a047ab170a72" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:8.459ex; height:2.843ex;" alt="{\displaystyle (A^{*},B^{*})}"/></span> an estimate of the minimizer of Problem Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:non-convex-frob-min" title="Equation 2" class="extermal text" rel="nofollow">2</a></li></ul>
<ul><li><b>Repeat until Convergence:</b></li></ul>
<ol><li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k\gets k+1}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo stretchy="false">&#x2190;<!-- ← --></mo>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k\gets k+1}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05bbecb55cad709b15ffcb487d28e022b562ff06" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.505ex; width:10.039ex; height:2.343ex;" alt="{\displaystyle k\gets k+1}"/></span></li>
<li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X^{*}\gets P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})=P_{\Omega }(X-AB^{T})+AB^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">&#x2190;<!-- ← --></mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X^{*}\gets P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})=P_{\Omega }(X-AB^{T})+AB^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1c371af09ccb7c8f7252be1124a1b7b9fb110cd8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:51.516ex; height:3.343ex;" alt="{\displaystyle X^{*}\gets P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})=P_{\Omega }(X-AB^{T})+AB^{T}}"/></span></li>
<li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\gets X^{*}B(B^{T}B+\lambda I)^{-1}={\text{argmin}}_{Z_{1}}Q_{A}(Z_{1}|A,B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2190;<!-- ← --></mo>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mi>B</mi>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>B</mi>
        <mo>+</mo>
        <mi>&#x03BB;<!-- λ --></mi>
        <mi>I</mi>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <mo>=</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mtext>argmin</mtext>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>Z</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mn>1</mn>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\gets X^{*}B(B^{T}B+\lambda I)^{-1}={\text{argmin}}_{Z_{1}}Q_{A}(Z_{1}|A,B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fbea10adabceb613afd2736057ed5a044fdf8fe6" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.171ex; width:49.938ex; height:3.509ex;" alt="{\displaystyle A\gets X^{*}B(B^{T}B+\lambda I)^{-1}={\text{argmin}}_{Z_{1}}Q_{A}(Z_{1}|A,B)}"/></span></li>
<li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X^{*}\gets P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})=P_{\Omega }(X-AB^{T})+AB^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">&#x2190;<!-- ← --></mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X^{*}\gets P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})=P_{\Omega }(X-AB^{T})+AB^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1c371af09ccb7c8f7252be1124a1b7b9fb110cd8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:51.516ex; height:3.343ex;" alt="{\displaystyle X^{*}\gets P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})=P_{\Omega }(X-AB^{T})+AB^{T}}"/></span></li>
<li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\gets X^{*T}A(A^{T}A+\lambda I)^{-1}={\text{argmin}}_{Z_{2}}Q_{B}(Z_{2}|A,B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2190;<!-- ← --></mo>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>A</mi>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>A</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>A</mi>
        <mo>+</mo>
        <mi>&#x03BB;<!-- λ --></mi>
        <mi>I</mi>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <mo>=</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mtext>argmin</mtext>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>Z</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mn>2</mn>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\gets X^{*T}A(A^{T}A+\lambda I)^{-1}={\text{argmin}}_{Z_{2}}Q_{B}(Z_{2}|A,B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/30f968a58a1edcdd80ede9654cc79d34fc75e159" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.171ex; width:51.068ex; height:3.509ex;" alt="{\displaystyle B\gets X^{*T}A(A^{T}A+\lambda I)^{-1}={\text{argmin}}_{Z_{2}}Q_{B}(Z_{2}|A,B)}"/></span> <span class="cross-id">(1)</span></li></ol></span></div>
<h2><span class="mw-headline" id="Debiased_softImpute-ALS">Debiased softImpute-ALS</span></h2>
<p>Hence, in our version of the algorithm, it makes sense to re-define the surrogate functions to account for debiasing.
</p>
<h3><span class="mw-headline" id="Surrogate_functions_2">Surrogate functions</span></h3>
<p>Again, let's re-state the objective function:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>B</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8dadd4fbd757a9d67b899667ef65368defc92452" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:53.994ex; height:5.343ex;" alt="{\displaystyle F(A,B):={\frac {1}{2}}||P_{\Omega }(X-AB^{T})||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}"/></span></dd></dl>
<p>And now, we modify the surrogate functions so that Hastie et al. proofs still work:
</p>
<dl><dd><div class="crossref-block" id="label-eq:Q_A_def_deb"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>B</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bfa7565a93af7e630ceaec176a7909e66160c3e8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:87.253ex; height:5.343ex;" alt="{\displaystyle Q_{A}^{*}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}"/></span> <span class="cross-id">(5)</span></span></div></dd></dl>
<p><br />
</p>
<dl><dd><div class="crossref-block" id="label-eq:Q_B_def_deb"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}^{*}(Z_{2}|A,B):={\frac {1}{2}}||P_{\Omega }(X-AZ_{2}^{T})+P_{\Omega }^{\bot }(AB^{T}-AZ_{2}^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||Z_{2}||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mi>A</mi>
        <msubsup>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <mi>A</mi>
        <msubsup>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}^{*}(Z_{2}|A,B):={\frac {1}{2}}||P_{\Omega }(X-AZ_{2}^{T})+P_{\Omega }^{\bot }(AB^{T}-AZ_{2}^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||Z_{2}||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4fd9d7f61a05ac6d79567410f9bac0c3c3045dfd" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:85.339ex; height:5.343ex;" alt="{\displaystyle Q_{B}^{*}(Z_{2}|A,B):={\frac {1}{2}}||P_{\Omega }(X-AZ_{2}^{T})+P_{\Omega }^{\bot }(AB^{T}-AZ_{2}^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||A||_{F}^{2}+{\frac {\lambda }{2}}||Z_{2}||_{F}^{2}}"/></span> <span class="cross-id">(6)</span></span></div></dd></dl>
<p>Notice that it's still true that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)\geq F(Z_{1},B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(Z_{1}|A,B)\geq F(Z_{1},B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/155ac331ad68168ccbbb2def65cbf6e054c27d13" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:25.03ex; height:3.009ex;" alt="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)\geq F(Z_{1},B)}"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}^{*}(Z_{2}|A,B)\geq F(A,Z_{2})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}^{*}(Z_{2}|A,B)\geq F(A,Z_{2})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1843b61094c1dfaa12355e1596593f39efc1a831" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:25.024ex; height:3.009ex;" alt="{\displaystyle Q_{B}^{*}(Z_{2}|A,B)\geq F(A,Z_{2})}"/></span>.
</p>
<h4><span class="mw-headline" id="Important_properties_of_surrogate_functions">Important properties of surrogate functions</span></h4>
<ul><li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)\geq F(Z_{1},B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(Z_{1}|A,B)\geq F(Z_{1},B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/155ac331ad68168ccbbb2def65cbf6e054c27d13" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:25.03ex; height:3.009ex;" alt="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)\geq F(Z_{1},B)}"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}^{*}(Z_{2}|A,B)\geq F(A,Z_{2})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}^{*}(Z_{2}|A,B)\geq F(A,Z_{2})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1843b61094c1dfaa12355e1596593f39efc1a831" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:25.024ex; height:3.009ex;" alt="{\displaystyle Q_{B}^{*}(Z_{2}|A,B)\geq F(A,Z_{2})}"/></span></li>
<li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(A|A,B)=F(A,B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(A|A,B)=F(A,B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/743b15cd3d9da5ce75af967149082b441cc8ded8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:23.233ex; height:3.009ex;" alt="{\displaystyle Q_{A}^{*}(A|A,B)=F(A,B)}"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}^{*}(B|A,B)=F(A,B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>F</mi>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}^{*}(B|A,B)=F(A,B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a6a0d481b45df55042c48d4f8200b4e3acb8c40f" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:23.269ex; height:3.009ex;" alt="{\displaystyle Q_{B}^{*}(B|A,B)=F(A,B)}"/></span></li>
<li>We can iteratively minimize each of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{B}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{B}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2d47686ee57e8d2b64f2826b3a82b7a3beebd4e2" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:3.318ex; height:2.509ex;" alt="{\displaystyle Q_{B}}"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/227df710321dff901d1b8a6908f21b1b4c3762ed" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:3.303ex; height:2.509ex;" alt="{\displaystyle Q_{A}}"/></span> to try to find a minimum of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle F}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>F</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle F}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/545fd099af8541605f7ee55f08225526be88ce57" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.741ex; height:2.176ex;" alt="{\displaystyle F}"/></span>. We don't know if it's a global minimum, but at least we know that the algorithm does not diverge. We also know that it reaches an <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \epsilon }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03F5;<!-- ϵ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \epsilon }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3837cad72483d97bcdde49c85d3b7b859fb3fd2" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:0.944ex; height:1.676ex;" alt="{\displaystyle \epsilon }"/></span>-bubble of a stationary point in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle O({\frac {1}{\epsilon }})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>O</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>&#x03F5;<!-- ϵ --></mi>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle O({\frac {1}{\epsilon }})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05f5b283f7f344fd766b0c3244904039754e5d7c" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:5.581ex; height:5.176ex;" alt="{\displaystyle O({\frac {1}{\epsilon }})}"/></span> iterations. Also there is an easy check if the solution is indeed a global minimum. Alternatively, solution can be used as a warm start for an algorithm with better guarantees.</li></ul>
<p>\begin{figure}
</p>
<pre>   \includegraphics[width=12cm]{ubcdiss-master/both_surrogate.png}
   \caption{Properties of surrogate functions, illustrated. Correction: $Q$ and $F$ should be convex if we only look at one variable at a time. This is actually kind of similar to Newton's method}
   
   \label{fig:both_surrogate}
</pre>
<p>\end{figure}
</p><p>\begin{figure}
</p>
<pre>   \includegraphics[width=12cm]{ubcdiss-master/2-iter.png}
   \caption{Illustration of one iteration of the algorithm. Again note that $Q$'s and $F$ should be convex along the $A$ and $B$ axes (but not necessarily along other axes).}
   
   \label{fig:2-iter}
</pre>
<p>\end{figure}
</p><p><br />
</p>
<h3><span class="mw-headline" id="Algorithm">Algorithm</span></h3>
<p>Algorithm essentially remains the same:
</p><p>\begin{algorithm}
\caption{\texttt{Debiased softImpute-ALS}}
\begin{algorithmic}[1]
\State \textbf{Inputs:} Data matrix $X$, initial iterates $A_0$ and $B_0$, and $k = 0$.
\State \textbf{Outputs:} $(A^*,B^*)$ an estimate of the minimizer of Problem Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:non-convex-frob-min" title="Equation 2" class="extermal text" rel="nofollow">2</a>
\State
\State \textbf{Repeat until Convergence}
\State $k \gets k + 1$
</p><p>\State $X^* \gets P_\Omega(X) + P_\Omega^\bot(AB^T)\circ\frac{1}{K}$
and $B^* \gets P_\Omega(B)+P_\Omega^\bot(B)\circ\frac{1}{K}$
</p><p>\State $A \gets X^*B^*(B^{*T}B^*+\lambda I)^{-1}=\text{argmin}_{Z_1}Q_A^*(Z_1|A,B)$
</p><p>\State $X^* \gets P_\Omega(X) + P_\Omega^\bot(AB^T)\circ\frac{1}{K}$
and $A^* \gets P_\Omega(A)+P_\Omega^\bot(A)\circ\frac{1}{K}$
</p><p>\State $B \gets X^{*T}A^*(A^{*T}A^*+\lambda I)^{-1}=\text{argmin}_{Z_2}Q_B^*(Z_2|A,B)$
\end{algorithmic} \label{alg:softImpute-ALS-deb}
\end{algorithm}
</p><p>\begin{lemm}
Derivation of $Q_A^*(Z_1|A,B)$ and $Q_B^*(Z_2|A,B)$ minimizers.
\end{lemm}
</p><p>\begin{proof}
</p><p>Let's begin with $Q_A^*$, since the other one is identical.
</p><p>It is useful to re-write the insides of $Q_A^*$ in the following form:
</p><p>\begin{equation}  \label{eq:Q_A_deb_insides}
\begin{aligned}
P_\Omega(X-Z_1B^T)+P_\Omega^\bot(AB^T-Z_1B^T)\circ\frac{1}{K} = \\ =
P_\Omega(X)
+P_\Omega^\bot(AB^T)\circ\frac{1}{K}
-P_\Omega(Z_1B^T)
-P_\Omega^\bot(Z_1B^T)\circ\frac{1}{K}
\end{aligned}
\end{equation}
</p><p>Define $X^*&#160;:= P_\Omega(X) + P_\Omega^\bot(AB^T)\circ\frac{1}{K}$. Then we get $X^*-P_\Omega(Z_1B^T)-P_\Omega^\bot(Z_1B^T)\circ\frac{1}{K}$ from the above equation. Finally, we get $X^* 
- Z_1 ( P_\Omega(B^T)+P_\Omega^\bot(B^T)\circ\frac{1}{K})$
</p><p>Thus, we re-write $Q_A^*$ as:
\begin{equation}  \label{eq:Q_A_def_deb_compact}
\begin{aligned}
Q_A^*(Z_1|A,B) =
\frac{1}{2}||X^* - Z_1 (P_\Omega(B^T)+P_\Omega^\bot(B^T)\circ\frac{1}{K})||_F^2
+ \frac{\lambda}{2}||Z_1||_F^2
+ \frac{\lambda}{2}||B||_F^2
\end{aligned}
\end{equation}
</p><p>For convinience, define $B^*&#160;:= P_\Omega(B)+P_\Omega^\bot(B)\circ\frac{1}{K}$. Then, even simpler form is:
</p><p>Thus, we re-write $Q_A^*$ as:
\begin{equation}  \label{eq:Q_A_def_deb_compact2}
\begin{aligned}
Q_A^*(Z_1|A,B) =
\frac{1}{2}||X^* - Z_1 B^{*T}||_F^2
+ \frac{\lambda}{2}||Z_1||_F^2
+ \frac{\lambda}{2}||B||_F^2
\end{aligned}
\end{equation}
</p><p>Now compute gradient ($Q_A^*$ is a function of $Z_1$):
</p><p>\begin{equation}  \label{eq:Q_A_def_deb_compact_der}
\begin{aligned}
\nabla Q_A^*(Z_1|A,B) = (X^* - Z_1 B^{*T})(-B^*)+ \lambda Z_1
\end{aligned}
\end{equation}
</p><p>Equating it to zero, we get that $Z_1 = X^*B^*(B^{*T}B^*+\lambda I)^{-1}$
</p><p>Note that later we would see that Hastie et al. give convergence speed guarantees in terms of bounds $\ell^U$ and $\ell^L$ in
$\ell^U \bm{I} \succeq B^TB \succeq \ell^L \bm{I}$ and 
$\ell^U \bm{I} \succeq A^TA \succeq \ell^L \bm{I}$. Thus, if we can show that $A^*$ and $B^*$ have tighter bounds compared to $A$ and $B$, we would prove that our algorithm converges to a stationary point faster than vanilla softImpute-ALS.
\end{proof}
</p><p>For completeness, let's prove that iterates of debiased softImpute-ALS decrease the objective function monotonically, just like the vanilla version:
</p><p>\begin{theorem}
Let ${(A_k, B_k)}$ be the iterates generated by the debiased softImpute-ALS. The function values are monotonically decreasing,
$$
F(A_k,B_k) \geq F(A_{k+1}, B_k) \geq F(A_{k+1}, B_{k+1}), k \geq 1.
$$
\end{theorem}
</p><p>\begin{proof}
Proof is identical to Hastie et. al's. We use the fact that
$$
F(A_{k+1},B_k) \leq
Q_A^*(A_{k+1}|A_k,B_k) =
\text{min}_{Z_1}Q_A^*(Z_1|A_k,B_k) \leq
Q_A^*(A_k|A_k,B_k) = 
F(A_k,B_k)$$
\end{proof}
</p>
<h2><span id="Loewner_order_(bounds_on_eigenvalues)"></span><span class="mw-headline" id="Loewner_order_.28bounds_on_eigenvalues.29">Loewner order (bounds on eigenvalues)</span></h2>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ell ^{U}\mathbf {I} \succeq B^{T}B\succeq \ell ^{L}\mathbf {I} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>&#x2113;<!-- ℓ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>U</mi>
          </mrow>
        </msup>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">I</mi>
        </mrow>
        <mo>&#x2AB0;<!-- ⪰ --></mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>B</mi>
        <mo>&#x2AB0;<!-- ⪰ --></mo>
        <msup>
          <mi>&#x2113;<!-- ℓ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>L</mi>
          </mrow>
        </msup>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">I</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ell ^{U}\mathbf {I} \succeq B^{T}B\succeq \ell ^{L}\mathbf {I} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/81e2e4b3aee34c7f725ba1352549a539e4ae5081" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.505ex; width:17.925ex; height:2.843ex;" alt="{\displaystyle \ell ^{U}\mathbf {I} \succeq B^{T}B\succeq \ell ^{L}\mathbf {I} }"/></span> and 
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ell ^{U}\mathbf {I} \succeq A^{T}A\succeq \ell ^{L}\mathbf {I} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>&#x2113;<!-- ℓ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>U</mi>
          </mrow>
        </msup>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">I</mi>
        </mrow>
        <mo>&#x2AB0;<!-- ⪰ --></mo>
        <msup>
          <mi>A</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>A</mi>
        <mo>&#x2AB0;<!-- ⪰ --></mo>
        <msup>
          <mi>&#x2113;<!-- ℓ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>L</mi>
          </mrow>
        </msup>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">I</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ell ^{U}\mathbf {I} \succeq A^{T}A\succeq \ell ^{L}\mathbf {I} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/448d2eedcf9f2200c9bba0b335b0960ae26dc6fa" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.505ex; width:17.884ex; height:2.843ex;" alt="{\displaystyle \ell ^{U}\mathbf {I} \succeq A^{T}A\succeq \ell ^{L}\mathbf {I} }"/></span>
basically give a bound on the smallest and largest eigenvalues of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B^{T}B}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>B</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B^{T}B}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f43e47a2aa41a97f865e1a7bb5ef9a83d1c54067" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:4.917ex; height:2.676ex;" alt="{\displaystyle B^{T}B}"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A^{T}A}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>A</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>A</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A^{T}A}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4cc54896247ebb4d60e721ac74dcf41614e18133" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:4.875ex; height:2.676ex;" alt="{\displaystyle A^{T}A}"/></span>. See <a href="https://en.wikipedia.org/wiki/Loewner_order" class="extiw" title="wikipedia:Loewner order">Loewner order</a>.
</p><p>Let's go:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo>=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4fcb6ac25c82fe6b9de39000f4864827d52f842e" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:21.093ex; height:3.176ex;" alt="{\displaystyle B=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)}"/></span></dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B^{*}=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)\circ {\frac {1}{K}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B^{*}=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)\circ {\frac {1}{K}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9175799a93ffb702b282f246f34c12477e736775" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:27.244ex; height:5.176ex;" alt="{\displaystyle B^{*}=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)\circ {\frac {1}{K}}}"/></span></dd></dl>
<p>Then:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B^{T}B=(P_{\Omega }(B)^{T}+P_{\Omega }(B)^{T})(P_{\Omega }(B)+P_{\Omega }(B))}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mi>B</mi>
        <mo>=</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B^{T}B=(P_{\Omega }(B)^{T}+P_{\Omega }(B)^{T})(P_{\Omega }(B)+P_{\Omega }(B))}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/58a7bb181f4c013dfba07edc851872b4942af5fe" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:46.031ex; height:3.176ex;" alt="{\displaystyle B^{T}B=(P_{\Omega }(B)^{T}+P_{\Omega }(B)^{T})(P_{\Omega }(B)+P_{\Omega }(B))}"/></span></dd></dl>
<p>and
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B^{*T}B^{*}=(P_{\Omega }(B)^{T}+P_{\Omega }(B)^{T}\circ {\frac {1}{K^{T}}})(P_{\Omega }(B)+P_{\Omega }(B)\circ {\frac {1}{K}})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
            <mi>T</mi>
          </mrow>
        </msup>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>=</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msup>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>T</mi>
              </mrow>
            </msup>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B^{*T}B^{*}=(P_{\Omega }(B)^{T}+P_{\Omega }(B)^{T}\circ {\frac {1}{K^{T}}})(P_{\Omega }(B)+P_{\Omega }(B)\circ {\frac {1}{K}})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/84051cba1506c4cb91425ab12d73c44245fc7df1" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.005ex; width:59.518ex; height:5.343ex;" alt="{\displaystyle B^{*T}B^{*}=(P_{\Omega }(B)^{T}+P_{\Omega }(B)^{T}\circ {\frac {1}{K^{T}}})(P_{\Omega }(B)+P_{\Omega }(B)\circ {\frac {1}{K}})}"/></span></dd></dl>
<p>So now we just want to show that distribution of eigenvalues of the second quantity is narrower than the first one.
</p><p>Another way to express <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B^{*}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B^{*}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/202be1fdef03f14a352508cf0bc32073470d44ca" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:2.818ex; height:2.343ex;" alt="{\displaystyle B^{*}}"/></span> is as:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B^{*}=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)-P_{\Omega }^{\bot }(B)+P_{\Omega }^{\bot }(B)\circ {\frac {1}{K}}=B+(I-{\frac {1}{K}})\circ P_{\Omega }^{\bot }(B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- − --></mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <mi>B</mi>
        <mo>+</mo>
        <mo stretchy="false">(</mo>
        <mi>I</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B^{*}=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)-P_{\Omega }^{\bot }(B)+P_{\Omega }^{\bot }(B)\circ {\frac {1}{K}}=B+(I-{\frac {1}{K}})\circ P_{\Omega }^{\bot }(B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3975fe2a9329e3398ed779fee5fdc1983a140196" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:72.263ex; height:5.176ex;" alt="{\displaystyle B^{*}=P_{\Omega }(B)+P_{\Omega }^{\bot }(B)-P_{\Omega }^{\bot }(B)+P_{\Omega }^{\bot }(B)\circ {\frac {1}{K}}=B+(I-{\frac {1}{K}})\circ P_{\Omega }^{\bot }(B)}"/></span>
</p><p>But wait, what is exactly <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }(B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }(B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/af386969b1d6cc75d0f36c2605e7bf0d56f70455" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:6.484ex; height:2.843ex;" alt="{\displaystyle P_{\Omega }(B)}"/></span>, considering that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/47136aad860d145f75f3eed3022df827cee94d7a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.764ex; height:2.176ex;" alt="{\displaystyle B}"/></span> might not even be a square matrix?
</p>
<h2><span class="mw-headline" id="Splitting_the_projection_operator">Splitting the projection operator</span></h2>
<p>In the algorithm we have a term:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0c33bf24c9bc9c5977bc16eface18556e6296965" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:41.946ex; height:5.176ex;" alt="{\displaystyle P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}}"/></span></dd></dl>
<p>Which can be re-written as:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})\circ {\frac {1}{K}}-P_{\Omega }(Z_{1}B^{T})-P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- − --></mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})\circ {\frac {1}{K}}-P_{\Omega }(Z_{1}B^{T})-P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7d67095d6e3be6db0a521618764fd58fdfca05b7" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:56.905ex; height:5.176ex;" alt="{\displaystyle P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})\circ {\frac {1}{K}}-P_{\Omega }(Z_{1}B^{T})-P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}}}"/></span></dd></dl>
<p>We are trying to solve for <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z_{1}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z_{1}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cea9e950915c77b3dcf9d4d54101820f538bc077" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:2.642ex; height:2.509ex;" alt="{\displaystyle Z_{1}}"/></span>, hence we are interested in the last two terms:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega }(Z_{1}B^{T})+P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega }(Z_{1}B^{T})+P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/257e5c918093177626494b9c522b5eb63006ff2f" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:29.389ex; height:5.176ex;" alt="{\displaystyle P_{\Omega }(Z_{1}B^{T})+P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}}}"/></span></dd></dl>
<p>Idea: Perhaps we can compute expected value of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(Z_{1}|A,B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4f54490ffed82dd5429139c8c99b0a8db72b0699" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:12.942ex; height:3.009ex;" alt="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)}"/></span> and minimize it?
If only we could show that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\text{argmin}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>argmin</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\text{argmin}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7ccf7642bcadd64a1c415a041b54ed2607a2294c" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:7.112ex; height:2.509ex;" alt="{\displaystyle {\text{argmin}}}"/></span> for the expected value is smaller than <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(A|A,B)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(A|A,B)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/74ad0e329b03004bb2132e5ef016f853db4c740e" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:12.043ex; height:3.009ex;" alt="{\displaystyle Q_{A}^{*}(A|A,B)}"/></span>, Hastie's arguments should still work.
</p>
<h3><span class="mw-headline" id="Reiterating_on_the_function_we_want_to_minimize">Reiterating on the function we want to minimize</span></h3>
<p>The function we want to see minimized is:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>B</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bfa7565a93af7e630ceaec176a7909e66160c3e8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:87.253ex; height:5.343ex;" alt="{\displaystyle Q_{A}^{*}(Z_{1}|A,B):={\frac {1}{2}}||P_{\Omega }(X-Z_{1}B^{T})+P_{\Omega }^{\bot }(AB^{T}-Z_{1}B^{T})\circ {\frac {1}{K}}||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}"/></span></dd></dl>
<p>In order to solve it, we might want to factor out <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z_{1}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z_{1}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cea9e950915c77b3dcf9d4d54101820f538bc077" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:2.642ex; height:2.509ex;" alt="{\displaystyle Z_{1}}"/></span>.
</p><p>Alternatively, we might just express it in Einstein notation. But, first let's simplify things a bit by defining:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X^{*}:=P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})\circ {\frac {1}{K}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>:=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X^{*}:=P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})\circ {\frac {1}{K}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ca41fb5c1006ff27247e5f57f83cf5cd7777b328" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:31.472ex; height:5.176ex;" alt="{\displaystyle X^{*}:=P_{\Omega }(X)+P_{\Omega }^{\bot }(AB^{T})\circ {\frac {1}{K}}}"/></span></dd></dl>
<p>Then:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)={\frac {1}{2}}||X^{*}-(P_{\Omega }(Z_{1}B^{T})+P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}})||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>&#x03BB;<!-- λ --></mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>B</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q_{A}^{*}(Z_{1}|A,B)={\frac {1}{2}}||X^{*}-(P_{\Omega }(Z_{1}B^{T})+P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}})||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/83eabb85aceb934c38f21419f891a78ec94350c8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:81.75ex; height:5.343ex;" alt="{\displaystyle Q_{A}^{*}(Z_{1}|A,B)={\frac {1}{2}}||X^{*}-(P_{\Omega }(Z_{1}B^{T})+P_{\Omega }^{\bot }(Z_{1}B^{T})\circ {\frac {1}{K}})||_{F}^{2}+{\frac {\lambda }{2}}||Z_{1}||_{F}^{2}+{\frac {\lambda }{2}}||B||_{F}^{2}}"/></span></dd></dl>
<p>Now, the last two terms are not very hard to differentiate, so let's focus on the first one:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle T(Z):={\frac {1}{2}}||X^{*}-(P_{\Omega }(ZB^{T})+P_{\Omega }^{\bot }(ZB^{T})\circ {\frac {1}{K}})||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>T</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T(Z):={\frac {1}{2}}||X^{*}-(P_{\Omega }(ZB^{T})+P_{\Omega }^{\bot }(ZB^{T})\circ {\frac {1}{K}})||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6f5749731a50638fa5a31157296171f11bf9566d" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:50.088ex; height:5.176ex;" alt="{\displaystyle T(Z):={\frac {1}{2}}||X^{*}-(P_{\Omega }(ZB^{T})+P_{\Omega }^{\bot }(ZB^{T})\circ {\frac {1}{K}})||_{F}^{2}}"/></span></dd></dl>
<div style="background-color: plum; border-style: solid; margin: 10px; padding: 10px; display:inline-block">
<p>Then:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik}(X_{ik}^{*}-(P_{\Omega }(ZB^{T})_{ik}+P_{\Omega }^{\bot }(ZB^{T})_{ik}{\frac {1}{K_{ik}}}))^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>T</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>i</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik}(X_{ik}^{*}-(P_{\Omega }(ZB^{T})_{ik}+P_{\Omega }^{\bot }(ZB^{T})_{ik}{\frac {1}{K_{ik}}}))^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/719b2a70768aeb16a83ee6a92b236fc040ee9047" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.005ex; width:55.853ex; height:6.343ex;" alt="{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik}(X_{ik}^{*}-(P_{\Omega }(ZB^{T})_{ik}+P_{\Omega }^{\bot }(ZB^{T})_{ik}{\frac {1}{K_{ik}}}))^{2}}"/></span></dd></dl>
<p>Split the sum:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-(ZB^{T})_{ik})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-(ZB^{T})_{ik}{\frac {1}{K_{ik}}}))^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>T</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>i</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-(ZB^{T})_{ik})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-(ZB^{T})_{ik}{\frac {1}{K_{ik}}}))^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/25688a7943757d6e4f8b1331cf117017c7d4877b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:64.433ex; height:6.843ex;" alt="{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-(ZB^{T})_{ik})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-(ZB^{T})_{ik}{\frac {1}{K_{ik}}}))^{2}}"/></span></dd></dl>
<p>Expand the matrix multiplication:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}))^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>T</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>i</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}))^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3606fef65cc09e7811c39816f04db0bf8ed04a30" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:68.509ex; height:6.843ex;" alt="{\displaystyle T(Z):={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}))^{2}}"/></span></dd></dl>
<p>Differentiate (WIP):
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}:={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}))^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>:=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>i</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}:={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}))^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c73a09048b85f38d355f28b048c10d597a9c4624" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:70.663ex; height:7.343ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}:={\frac {1}{2}}\sum _{ik\in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T})^{2}+{\frac {1}{2}}\sum _{ik\not \in \Omega }(X_{ik}^{*}-\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}))^{2}}"/></span></dd></dl>
</div>
<p>But wait, we can go another way. Consider <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle T(Z)={\frac {1}{2}}||X^{*}-M(Z)||_{F}^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>T</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <mi>M</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">|</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>F</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T(Z)={\frac {1}{2}}||X^{*}-M(Z)||_{F}^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/32c2672699b3088813c46490615707d72290c491" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:26.097ex; height:5.176ex;" alt="{\displaystyle T(Z)={\frac {1}{2}}||X^{*}-M(Z)||_{F}^{2}}"/></span>,
where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle M(Z):=P_{\Omega }(ZB^{T})+P_{\Omega }^{\bot }(ZB^{T})\circ {\frac {1}{K}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>M</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo>:=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msubsup>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2218;<!-- ∘ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle M(Z):=P_{\Omega }(ZB^{T})+P_{\Omega }^{\bot }(ZB^{T})\circ {\frac {1}{K}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bd4b168d31a9bfb403aac2b1962fd7bcb40afb33" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:37.144ex; height:5.176ex;" alt="{\displaystyle M(Z):=P_{\Omega }(ZB^{T})+P_{\Omega }^{\bot }(ZB^{T})\circ {\frac {1}{K}}}"/></span>. Then:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z}}=(X^{*}-M(Z)){\frac {\partial M(Z)}{\partial Z}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>Z</mi>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <mi>M</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>M</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>Z</mi>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z}}=(X^{*}-M(Z)){\frac {\partial M(Z)}{\partial Z}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4d426f33ecadf3d5e91a0ca33fc67a3234fd0cf6" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.005ex; width:32.097ex; height:5.843ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z}}=(X^{*}-M(Z)){\frac {\partial M(Z)}{\partial Z}}}"/></span>.</dd></dl>
<p>So, essentially, we only need to compute <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial M(Z)}{\partial Z}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>M</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>Z</mi>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial M(Z)}{\partial Z}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6eacdac177501948c12ab61c6322f5c1d1174117" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.005ex; width:8.086ex; height:5.843ex;" alt="{\displaystyle {\frac {\partial M(Z)}{\partial Z}}}"/></span>.
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle M(Z)_{ik}={\begin{cases}(ZB^{T})_{ik}&amp;ik\in \Omega \\(ZB^{T})_{ik}{\frac {1}{K_{ik}}}&amp;ik\not \in \Omega \end{cases}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>M</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow>
            <mo>{</mo>
            <mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false">
              <mtr>
                <mtd>
                  <mo stretchy="false">(</mo>
                  <mi>Z</mi>
                  <msup>
                    <mi>B</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>T</mi>
                    </mrow>
                  </msup>
                  <msub>
                    <mo stretchy="false">)</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>i</mi>
                      <mi>k</mi>
                    </mrow>
                  </msub>
                </mtd>
                <mtd>
                  <mi>i</mi>
                  <mi>k</mi>
                  <mo>&#x2208;<!-- ∈ --></mo>
                  <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mo stretchy="false">(</mo>
                  <mi>Z</mi>
                  <msup>
                    <mi>B</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>T</mi>
                    </mrow>
                  </msup>
                  <msub>
                    <mo stretchy="false">)</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>i</mi>
                      <mi>k</mi>
                    </mrow>
                  </msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mfrac>
                      <mn>1</mn>
                      <msub>
                        <mi>K</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>i</mi>
                          <mi>k</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                  </mrow>
                </mtd>
                <mtd>
                  <mi>i</mi>
                  <mi>k</mi>
                  <mo>&#x2209;</mo>
                  <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                </mtd>
              </mtr>
            </mtable>
            <mo fence="true" stretchy="true" symmetric="true"></mo>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle M(Z)_{ik}={\begin{cases}(ZB^{T})_{ik}&amp;ik\in \Omega \\(ZB^{T})_{ik}{\frac {1}{K_{ik}}}&amp;ik\not \in \Omega \end{cases}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2ac82d897600138fdf14af72d27a2e38c50efa23" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.171ex; width:34.017ex; height:7.509ex;" alt="{\displaystyle M(Z)_{ik}={\begin{cases}(ZB^{T})_{ik}&amp;ik\in \Omega \\(ZB^{T})_{ik}{\frac {1}{K_{ik}}}&amp;ik\not \in \Omega \end{cases}}}"/></span></dd></dl>
<p>Expand the matrix multiplication:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle M(Z)_{ik}={\begin{cases}\sum _{j}Z_{ij}B_{jk}^{T}&amp;ik\in \Omega \\\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}&amp;ik\not \in \Omega \end{cases}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>M</mi>
        <mo stretchy="false">(</mo>
        <mi>Z</mi>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow>
            <mo>{</mo>
            <mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false">
              <mtr>
                <mtd>
                  <munder>
                    <mo>&#x2211;<!-- ∑ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <msub>
                    <mi>Z</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>i</mi>
                      <mi>j</mi>
                    </mrow>
                  </msub>
                  <msubsup>
                    <mi>B</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>j</mi>
                      <mi>k</mi>
                    </mrow>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>T</mi>
                    </mrow>
                  </msubsup>
                </mtd>
                <mtd>
                  <mi>i</mi>
                  <mi>k</mi>
                  <mo>&#x2208;<!-- ∈ --></mo>
                  <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <munder>
                    <mo>&#x2211;<!-- ∑ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <msub>
                    <mi>Z</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>i</mi>
                      <mi>j</mi>
                    </mrow>
                  </msub>
                  <msubsup>
                    <mi>B</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>j</mi>
                      <mi>k</mi>
                    </mrow>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>T</mi>
                    </mrow>
                  </msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mfrac>
                      <mn>1</mn>
                      <msub>
                        <mi>K</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>i</mi>
                          <mi>k</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                  </mrow>
                </mtd>
                <mtd>
                  <mi>i</mi>
                  <mi>k</mi>
                  <mo>&#x2209;</mo>
                  <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                </mtd>
              </mtr>
            </mtable>
            <mo fence="true" stretchy="true" symmetric="true"></mo>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle M(Z)_{ik}={\begin{cases}\sum _{j}Z_{ij}B_{jk}^{T}&amp;ik\in \Omega \\\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}&amp;ik\not \in \Omega \end{cases}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/21e8f0eb9788aec88030da79f3dd5b12bcb2bbd2" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.171ex; width:36.063ex; height:7.509ex;" alt="{\displaystyle M(Z)_{ik}={\begin{cases}\sum _{j}Z_{ij}B_{jk}^{T}&amp;ik\in \Omega \\\sum _{j}Z_{ij}B_{jk}^{T}{\frac {1}{K_{ik}}}&amp;ik\not \in \Omega \end{cases}}}"/></span></dd></dl>
<p>And now we finally differentiate:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <msub>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>i</mi>
                  <mi>k</mi>
                </mrow>
              </msub>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/32001f563cd0f2dbb999023ad9d6b5dc5dea7c5a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.338ex; width:8.936ex; height:6.176ex;" alt="{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}}"/></span></dd></dl>
<p>So it's order 4 tensor. Need to consider the cases. 
We essentially have a product of two options: <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/13eb46a54e6073eccd64e301a3bb8a8ef545cdca" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.532ex; height:2.176ex;" alt="{\displaystyle ik\in \Omega }"/></span>,
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\not \in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2209;</mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\not \in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1f2c1a3884916b4fa23ecf960d0ed62e4c73b2af" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:6.532ex; height:2.676ex;" alt="{\displaystyle ik\not \in \Omega }"/></span>, and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a=i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>=</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a=i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/46ea62fd8d9c7f055ae3c2307163abb7d3004316" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.131ex; height:2.176ex;" alt="{\displaystyle a=i}"/></span>, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a\not =i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>&#x2260;</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a\not =i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c1987799d337478f774f2572913f5b8f23b22ee8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:5.131ex; height:2.676ex;" alt="{\displaystyle a\not =i}"/></span>:
</p>
<table class="wikitable">

<tbody><tr>
<td></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a=i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>=</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a=i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/46ea62fd8d9c7f055ae3c2307163abb7d3004316" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.131ex; height:2.176ex;" alt="{\displaystyle a=i}"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a\not =i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>&#x2260;</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a\not =i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c1987799d337478f774f2572913f5b8f23b22ee8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:5.131ex; height:2.676ex;" alt="{\displaystyle a\not =i}"/></span>
</td></tr>
<tr>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/13eb46a54e6073eccd64e301a3bb8a8ef545cdca" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.532ex; height:2.176ex;" alt="{\displaystyle ik\in \Omega }"/></span></td>
<td>...</td>
<td>...
</td></tr>
<tr>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\not \in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2209;</mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\not \in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1f2c1a3884916b4fa23ecf960d0ed62e4c73b2af" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:6.532ex; height:2.676ex;" alt="{\displaystyle ik\not \in \Omega }"/></span></td>
<td>...</td>
<td>...
</td></tr></tbody></table>
<p>Say, for example, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/13eb46a54e6073eccd64e301a3bb8a8ef545cdca" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.532ex; height:2.176ex;" alt="{\displaystyle ik\in \Omega }"/></span>, then:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}={\frac {\partial \sum _{j}Z_{ij}B_{jk}^{T}}{\partial {Z_{ab}}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <msub>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>i</mi>
                  <mi>k</mi>
                </mrow>
              </msub>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <munder>
                <mo>&#x2211;<!-- ∑ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>j</mi>
                </mrow>
              </munder>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>i</mi>
                  <mi>j</mi>
                </mrow>
              </msub>
              <msubsup>
                <mi>B</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>j</mi>
                  <mi>k</mi>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>T</mi>
                </mrow>
              </msubsup>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <msub>
                  <mi>Z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>a</mi>
                    <mi>b</mi>
                  </mrow>
                </msub>
              </mrow>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}={\frac {\partial \sum _{j}Z_{ij}B_{jk}^{T}}{\partial {Z_{ab}}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4de44a1cb912dee366d364eade245875ee6dfc6d" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.338ex; width:24.922ex; height:6.843ex;" alt="{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}={\frac {\partial \sum _{j}Z_{ij}B_{jk}^{T}}{\partial {Z_{ab}}}}}"/></span></dd></dl>
<p>Then, if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a\not =i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>&#x2260;</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a\not =i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c1987799d337478f774f2572913f5b8f23b22ee8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:5.131ex; height:2.676ex;" alt="{\displaystyle a\not =i}"/></span>, the above is zero. Otherwise (if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a=i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>=</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a=i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/46ea62fd8d9c7f055ae3c2307163abb7d3004316" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.131ex; height:2.176ex;" alt="{\displaystyle a=i}"/></span>), we need <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b=j}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>b</mi>
        <mo>=</mo>
        <mi>j</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b=j}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/02a2d285054ffd06e8c39593eab85ad921bb533d" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:5.054ex; height:2.509ex;" alt="{\displaystyle b=j}"/></span>:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}=B_{bk}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <msub>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>i</mi>
                  <mi>k</mi>
                </mrow>
              </msub>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}=B_{bk}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dcb7fa38772441124972245dadef7b0989860651" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.338ex; width:15.593ex; height:6.176ex;" alt="{\displaystyle {\frac {\partial T(Z)_{ik}}{\partial Z_{ab}}}=B_{bk}^{T}}"/></span></dd></dl>
<p>Approach for the case <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\not \in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2209;</mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\not \in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1f2c1a3884916b4fa23ecf960d0ed62e4c73b2af" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:6.532ex; height:2.676ex;" alt="{\displaystyle ik\not \in \Omega }"/></span> is identical. This gives us the following table:
</p>
<table class="wikitable">

<tbody><tr>
<td></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a=i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>=</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a=i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/46ea62fd8d9c7f055ae3c2307163abb7d3004316" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.131ex; height:2.176ex;" alt="{\displaystyle a=i}"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a\not =i}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>&#x2260;</mo>
        <mi>i</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a\not =i}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c1987799d337478f774f2572913f5b8f23b22ee8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:5.131ex; height:2.676ex;" alt="{\displaystyle a\not =i}"/></span>
</td></tr>
<tr>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/13eb46a54e6073eccd64e301a3bb8a8ef545cdca" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.532ex; height:2.176ex;" alt="{\displaystyle ik\in \Omega }"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B_{bk}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B_{bk}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ebd601f658b8adc3c706975abe97ca1061f682ed" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:3.558ex; height:3.176ex;" alt="{\displaystyle B_{bk}^{T}}"/></span></td>
<td>0
</td></tr>
<tr>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle ik\not \in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mi>k</mi>
        <mo>&#x2209;</mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ik\not \in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1f2c1a3884916b4fa23ecf960d0ed62e4c73b2af" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:6.532ex; height:2.676ex;" alt="{\displaystyle ik\not \in \Omega }"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B_{bk}^{T}{\frac {1}{K_{ak}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B_{bk}^{T}{\frac {1}{K_{ak}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/87bfa04195e2a474a434495cfb554ea304b95778" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.338ex; width:8.326ex; height:5.676ex;" alt="{\displaystyle B_{bk}^{T}{\frac {1}{K_{ak}}}}"/></span></td>
<td>0
</td></tr></tbody></table>
<p>We can finally get the complete derivative:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{ak\in \Omega }(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T})B_{bk}^{T}+\sum _{ak\not \in \Omega }(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}})B_{bk}^{T}{\frac {1}{K_{ak}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{ak\in \Omega }(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T})B_{bk}^{T}+\sum _{ak\not \in \Omega }(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}})B_{bk}^{T}{\frac {1}{K_{ak}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/71b102d7cd9bed01abbd52cc228fb01ecf8d59c9" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:76.231ex; height:7.343ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{ak\in \Omega }(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T})B_{bk}^{T}+\sum _{ak\not \in \Omega }(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}})B_{bk}^{T}{\frac {1}{K_{ak}}}}"/></span></dd></dl>
<p>Perhaps we can introduce a "one-dimensional" function <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \Omega _{a}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \Omega _{a}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a105899f4dc585fc145b025ac475c5780fd03b69" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:2.78ex; height:2.509ex;" alt="{\displaystyle \Omega _{a}}"/></span>:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k\in \Omega _{a}}(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T})B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}})B_{bk}^{T}{\frac {1}{K_{ak}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k\in \Omega _{a}}(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T})B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}})B_{bk}^{T}{\frac {1}{K_{ak}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8115cb230193d512b6e65da7a537e2c0121ec6e3" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:76.232ex; height:7.343ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k\in \Omega _{a}}(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T})B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}(X_{ak}^{*}-\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}})B_{bk}^{T}{\frac {1}{K_{ak}}}}"/></span></dd></dl>
<p>Now we just need to combine the sums into one sum, and we can apply a regular matrix inversion.
</p><p>First, let's expand the expression:
</p>
<dl><dd><div class="crossref-block" id="label-eq:expanded-der-TZ"><span class="crossref-content"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k\in \Omega _{a}}X_{ak}^{*}B_{bk}^{T}-\sum _{k\in \Omega _{a}}\sum _{j}Z_{aj}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}X_{ak}^{*}B_{bk}^{T}{\frac {1}{K_{ak}}}-\sum _{k\not \in \Omega _{a}}\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}}B_{bk}^{T}{\frac {1}{K_{ak}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k\in \Omega _{a}}X_{ak}^{*}B_{bk}^{T}-\sum _{k\in \Omega _{a}}\sum _{j}Z_{aj}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}X_{ak}^{*}B_{bk}^{T}{\frac {1}{K_{ak}}}-\sum _{k\not \in \Omega _{a}}\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}}B_{bk}^{T}{\frac {1}{K_{ak}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b8d5e2c2d5c2325dbaa246f6ab73759a3087b9c7" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:94.065ex; height:7.343ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k\in \Omega _{a}}X_{ak}^{*}B_{bk}^{T}-\sum _{k\in \Omega _{a}}\sum _{j}Z_{aj}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}X_{ak}^{*}B_{bk}^{T}{\frac {1}{K_{ak}}}-\sum _{k\not \in \Omega _{a}}\sum _{j}Z_{aj}B_{jk}^{T}{\frac {1}{K_{ak}}}B_{bk}^{T}{\frac {1}{K_{ak}}}}"/></span> <span class="cross-id">(7)</span></span></div></dd></dl>
<p>At this point, it seems useful to define another projection operator:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega _{a}}(B^{T})_{bk}={\begin{cases}B_{bk}^{T}&amp;k\in \Omega _{a}\\0&amp;k\not \in \Omega _{a}\end{cases}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow>
            <mo>{</mo>
            <mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false">
              <mtr>
                <mtd>
                  <msubsup>
                    <mi>B</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>b</mi>
                      <mi>k</mi>
                    </mrow>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>T</mi>
                    </mrow>
                  </msubsup>
                </mtd>
                <mtd>
                  <mi>k</mi>
                  <mo>&#x2208;<!-- ∈ --></mo>
                  <msub>
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>a</mi>
                    </mrow>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>k</mi>
                  <mo>&#x2209;</mo>
                  <msub>
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>a</mi>
                    </mrow>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo fence="true" stretchy="true" symmetric="true"></mo>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega _{a}}(B^{T})_{bk}={\begin{cases}B_{bk}^{T}&amp;k\in \Omega _{a}\\0&amp;k\not \in \Omega _{a}\end{cases}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bef64f5d8b10565c77d67e9456e71c2793d1440f" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.505ex; width:28.844ex; height:6.176ex;" alt="{\displaystyle P_{\Omega _{a}}(B^{T})_{bk}={\begin{cases}B_{bk}^{T}&amp;k\in \Omega _{a}\\0&amp;k\not \in \Omega _{a}\end{cases}}}"/></span></dd></dl>
<p>Similarly:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P_{\Omega _{a}^{\bot }}(B^{T})_{bk}={\begin{cases}0&amp;k\in \Omega _{a}\\B_{bk}^{T}&amp;k\not \in \Omega _{a}\end{cases}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow>
            <mo>{</mo>
            <mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false">
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>k</mi>
                  <mo>&#x2208;<!-- ∈ --></mo>
                  <msub>
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>a</mi>
                    </mrow>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msubsup>
                    <mi>B</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>b</mi>
                      <mi>k</mi>
                    </mrow>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>T</mi>
                    </mrow>
                  </msubsup>
                </mtd>
                <mtd>
                  <mi>k</mi>
                  <mo>&#x2209;</mo>
                  <msub>
                    <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>a</mi>
                    </mrow>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo fence="true" stretchy="true" symmetric="true"></mo>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P_{\Omega _{a}^{\bot }}(B^{T})_{bk}={\begin{cases}0&amp;k\in \Omega _{a}\\B_{bk}^{T}&amp;k\not \in \Omega _{a}\end{cases}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05850d4c83c3ccc12b2b83c4bd14b95a4321331c" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.505ex; width:29.176ex; height:6.176ex;" alt="{\displaystyle P_{\Omega _{a}^{\bot }}(B^{T})_{bk}={\begin{cases}0&amp;k\in \Omega _{a}\\B_{bk}^{T}&amp;k\not \in \Omega _{a}\end{cases}}}"/></span></dd></dl>
<p>Now, we can rewrite Equation <a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#label-eq:expanded-der-TZ" title="Equation 7" class="extermal text" rel="nofollow">7</a> as:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}(P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}}})-\sum _{j}Z_{aj}(\sum _{k\in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}{\frac {1}{K_{ak}^{2}}})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mn>2</mn>
              </mrow>
            </msubsup>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}(P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}}})-\sum _{j}Z_{aj}(\sum _{k\in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}{\frac {1}{K_{ak}^{2}}})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a81b1bac914e3b7e11ad8be2817fcb23f8304c46" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:91.165ex; height:7.343ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}(P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}}})-\sum _{j}Z_{aj}(\sum _{k\in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}{\frac {1}{K_{ak}^{2}}})}"/></span></dd></dl>
<p>The second product in the second term (<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sum _{k\in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}{\frac {1}{K_{ak}^{2}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2209;</mo>
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </munder>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mn>2</mn>
              </mrow>
            </msubsup>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sum _{k\in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}{\frac {1}{K_{ak}^{2}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bfb0448524da7b3e4f0f2548a1ea726cfde6ef1c" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.505ex; width:30.578ex; height:6.843ex;" alt="{\displaystyle \sum _{k\in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}+\sum _{k\not \in \Omega _{a}}B_{jk}^{T}B_{bk}^{T}{\frac {1}{K_{ak}^{2}}}}"/></span>) can then be re-written as:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sum _{k}(P_{\Omega _{a}}(B^{T})_{jk}P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}^{2}}})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mn>2</mn>
              </mrow>
            </msubsup>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sum _{k}(P_{\Omega _{a}}(B^{T})_{jk}P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}^{2}}})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6708fbf117509d55eb6cc605a1bae2bf73142052" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.005ex; width:55.532ex; height:6.343ex;" alt="{\displaystyle \sum _{k}(P_{\Omega _{a}}(B^{T})_{jk}P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}^{2}}})}"/></span></dd></dl>
<p>Is this equivalent to the expression below?
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sum _{k}(P_{\Omega _{a}}(B^{T})_{jk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}{\frac {1}{K_{ak}}})(P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}}})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sum _{k}(P_{\Omega _{a}}(B^{T})_{jk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}{\frac {1}{K_{ak}}})(P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}}})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f00dba2a9b06aae4eeaf5d049f4c49a2ad2aa486" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.005ex; width:64.95ex; height:6.343ex;" alt="{\displaystyle \sum _{k}(P_{\Omega _{a}}(B^{T})_{jk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}{\frac {1}{K_{ak}}})(P_{\Omega _{a}}(B^{T})_{bk}+P_{\Omega _{a}^{\bot }}(B^{T})_{bk}{\frac {1}{K_{ak}}})}"/></span></dd></dl>
<p>Seems like it. Just think about what happens when <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k\in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k\in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c7b9cbee9d601b9552f31f1868961819f37d86f4" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:5.73ex; height:2.176ex;" alt="{\displaystyle k\in \Omega }"/></span> and when <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k\not \in \Omega }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo>&#x2209;</mo>
        <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k\not \in \Omega }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3511744cdd4a4920334f3067c93836f0cf1786e" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:5.73ex; height:2.676ex;" alt="{\displaystyle k\not \in \Omega }"/></span>.
</p><p>We can now define <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\hat {B}}_{a,jk}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\hat {B}}_{a,jk}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5a91d22db321f2d1c0150c5f35a5933f44ca5023" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.171ex; width:4.857ex; height:4.176ex;" alt="{\displaystyle {\hat {B}}_{a,jk}^{T}}"/></span> as:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\hat {B}}_{a,jk}^{T}=P_{\Omega _{a}}(B^{T})_{jk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}{\frac {1}{K_{ak}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>=</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>P</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="normal">&#x22A5;<!-- ⊥ --></mi>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
        <msub>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>a</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\hat {B}}_{a,jk}^{T}=P_{\Omega _{a}}(B^{T})_{jk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}{\frac {1}{K_{ak}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a26328df26ff6f0a63389d7c2efe7a0444f81e86" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.338ex; width:36.916ex; height:5.676ex;" alt="{\displaystyle {\hat {B}}_{a,jk}^{T}=P_{\Omega _{a}}(B^{T})_{jk}+P_{\Omega _{a}^{\bot }}(B^{T})_{jk}{\frac {1}{K_{ak}}}}"/></span></dd></dl>
<p>In this case, we can re-write the derivative as:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}{\hat {B}}_{a,bk}^{T}-\sum _{k}\sum _{j}Z_{aj}{\hat {B}}_{a,jk}^{T}{\hat {B}}_{a,bk}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>b</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}{\hat {B}}_{a,bk}^{T}-\sum _{k}\sum _{j}Z_{aj}{\hat {B}}_{a,jk}^{T}{\hat {B}}_{a,bk}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/abaae0bfff92a6a4c86831c50400762eda70b70e" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.338ex; width:46.322ex; height:7.176ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}{\hat {B}}_{a,bk}^{T}-\sum _{k}\sum _{j}Z_{aj}{\hat {B}}_{a,jk}^{T}{\hat {B}}_{a,bk}^{T}}"/></span></dd></dl>
<p>Also, I think there is an error in my derivation, and in fact, indices of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\hat {B}}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\hat {B}}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d4fb3052e15eb16249352609da344d95c457945e" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:3.153ex; height:3.343ex;" alt="{\displaystyle {\hat {B}}^{T}}"/></span> should be switched in some places:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}{\hat {B}}_{a,kb}^{T}-\sum _{k}\sum _{j}Z_{aj}{\hat {B}}_{a,jk}^{T}{\hat {B}}_{a,kb}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>k</mi>
            <mi>b</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </munder>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>j</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>k</mi>
            <mi>b</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}{\hat {B}}_{a,kb}^{T}-\sum _{k}\sum _{j}Z_{aj}{\hat {B}}_{a,jk}^{T}{\hat {B}}_{a,kb}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c606187f51146cc6ff07bdfdca48505cb6f5c541" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.338ex; width:46.322ex; height:7.176ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=\sum _{k}X_{ak}^{*}{\hat {B}}_{a,kb}^{T}-\sum _{k}\sum _{j}Z_{aj}{\hat {B}}_{a,jk}^{T}{\hat {B}}_{a,kb}^{T}}"/></span></dd></dl>
<p>Now we can re-write it using Einstein notation to better illustrate what is going on:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=X_{ak}^{*}{\hat {B}}_{a,b}^{kT}-Z_{aj}{\hat {B}}_{a,k}^{jT}{\hat {B}}_{a,b}^{kT}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <mi>T</mi>
              <mo stretchy="false">(</mo>
              <mi>Z</mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- ∂ --></mi>
              <msub>
                <mi>Z</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                  <mi>b</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>b</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mi>j</mi>
          </mrow>
        </msub>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
            <mo>,</mo>
            <mi>b</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=X_{ak}^{*}{\hat {B}}_{a,b}^{kT}-Z_{aj}{\hat {B}}_{a,k}^{jT}{\hat {B}}_{a,b}^{kT}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9a0d4b9e662d33428109628d968e3d056204f7ee" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.338ex; width:32.705ex; height:6.176ex;" alt="{\displaystyle {\frac {\partial T(Z)}{\partial Z_{ab}}}=X_{ak}^{*}{\hat {B}}_{a,b}^{kT}-Z_{aj}{\hat {B}}_{a,k}^{jT}{\hat {B}}_{a,b}^{kT}}"/></span></dd></dl>
<p>Now, equate it to zero, and fix <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ffd2487510aa438433a2579450ab2b3d557e5edc" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.23ex; height:1.676ex;" alt="{\displaystyle a}"/></span>, while combining over all <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>b</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f11423fbb2e967f986e36804a8ae4271734917c3" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:0.998ex; height:2.176ex;" alt="{\displaystyle b}"/></span>'s into a vector:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X_{a}^{*}{\hat {B}}_{a}^{T}=Z_{a}{\hat {B}}_{a}^{T}{\hat {B}}_{a}^{T}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <mo>=</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X_{a}^{*}{\hat {B}}_{a}^{T}=Z_{a}{\hat {B}}_{a}^{T}{\hat {B}}_{a}^{T}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c7c23e009857ecf084fd61066d4c335700b07367" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:18.299ex; height:3.843ex;" alt="{\displaystyle X_{a}^{*}{\hat {B}}_{a}^{T}=Z_{a}{\hat {B}}_{a}^{T}{\hat {B}}_{a}^{T}}"/></span></dd></dl>
<p>The details of this expression don't seem right. But the general shape seems reasonable. This looks pretty much like ALS. So, we can expect this algorithm to behave better than ALS, but it requires more computations compared to SoftImpute-ALS.
</p><p>The correct formula probably looks like:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle X_{a}^{*}{\hat {B}}_{a}=Z_{a}^{T}{\hat {B}}_{a}{\hat {B}}_{a}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <msubsup>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msubsup>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X_{a}^{*}{\hat {B}}_{a}=Z_{a}^{T}{\hat {B}}_{a}{\hat {B}}_{a}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4996b2fbe7358f4cddbec893256b3a1722a208a6" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:17.845ex; height:3.176ex;" alt="{\displaystyle X_{a}^{*}{\hat {B}}_{a}=Z_{a}^{T}{\hat {B}}_{a}{\hat {B}}_{a}}"/></span></dd></dl>
<p>And this gives:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z_{a}=X_{a}^{*}{\hat {B}}_{a}\left({\hat {B}}_{a}^{T}{\hat {B}}_{a}\right)^{-1}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msubsup>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>B</mi>
                      <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                    </mover>
                  </mrow>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>T</mi>
                </mrow>
              </msubsup>
              <msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>B</mi>
                      <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                    </mover>
                  </mrow>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                </mrow>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z_{a}=X_{a}^{*}{\hat {B}}_{a}\left({\hat {B}}_{a}^{T}{\hat {B}}_{a}\right)^{-1}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9853dded03ce0c73bcd631279aad4e82fc81a2fe" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:22.832ex; height:5.176ex;" alt="{\displaystyle Z_{a}=X_{a}^{*}{\hat {B}}_{a}\left({\hat {B}}_{a}^{T}{\hat {B}}_{a}\right)^{-1}}"/></span></dd></dl>
<p>Adding <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b43d0ea3c9c025af1be9128e62a18fa74bedda2a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.355ex; height:2.176ex;" alt="{\displaystyle \lambda }"/></span>:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Z_{a}=X_{a}^{*}{\hat {B}}_{a}\left({\hat {B}}_{a}^{T}{\hat {B}}_{a}+\lambda I\right)^{-1}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <msubsup>
          <mi>X</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>B</mi>
                <mo stretchy="false">&#x005E;<!-- ^ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>a</mi>
          </mrow>
        </msub>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msubsup>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>B</mi>
                      <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                    </mover>
                  </mrow>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>T</mi>
                </mrow>
              </msubsup>
              <msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>B</mi>
                      <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                    </mover>
                  </mrow>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>a</mi>
                </mrow>
              </msub>
              <mo>+</mo>
              <mi>&#x03BB;<!-- λ --></mi>
              <mi>I</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Z_{a}=X_{a}^{*}{\hat {B}}_{a}\left({\hat {B}}_{a}^{T}{\hat {B}}_{a}+\lambda I\right)^{-1}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/91d028d341994f1ff845e71a228f62091b48f60b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:28.2ex; height:5.176ex;" alt="{\displaystyle Z_{a}=X_{a}^{*}{\hat {B}}_{a}\left({\hat {B}}_{a}^{T}{\hat {B}}_{a}+\lambda I\right)^{-1}}"/></span></dd></dl>
<p>TODO: Check this carefully (there's probably an alternative derivation).
</p>
<h2><span class="mw-headline" id="Continuation">Continuation</span></h2>
<p>Continues at <a href="wiki/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing/Debiased_Algorithm.html" title="Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing/Debiased Algorithm">Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing/Debiased_Algorithm</a>.
</p>
<h2><span class="mw-headline" id="References">References</span></h2><div class="mw-references-wrap"><ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#cite_ref-1">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://arxiv.org/abs/1312.0925">https://arxiv.org/abs/1312.0925</a></span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#cite_ref-2">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://arxiv.org/abs/1212.0467">https://arxiv.org/abs/1212.0467</a></span>
</li>
</ol></div>
<!-- 
NewPP limit report
Cached time: 20201215164716
Cache expiry: 86400
Dynamic content: false
Complications: []
[SMW] In‐text annotation parser time: 0 seconds
CPU time usage: 1.359 seconds
Real time usage: 2.235 seconds
Preprocessor visited node count: 769/1000000
Preprocessor generated node count: 0/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 7053/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key my_wiki:pcache:idhash:27-0!canonical!math=5 and timestamp 20201215164714 and revision id 303
 -->
</div><div class="scite-content"><h2 id="References">References</h2>
<div class="scite-referencelist responsive-list" dir="ltr"><div class="scite-referencelist-columns-responsive" style="width:100%;" dir="ltr"><ol start=1><li id="scite-8834f78b18f26ea5ac7fad69d0836d6c"><span class="scite-referencelinks"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#scite-ref-8834f78b18f26ea5ac7fad69d0836d6c-1-a" class="scite-backlink" data-citeref-format="number">^</a></span>&nbsp;<span class="scite-citation"><span class="scite-citation-resourcelink"><a href="wiki/Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing-2FReferences-23-5FSCITE8834f78b18f26ea5ac7fad69d0836d6c.html" title="Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing-2FReferences-23-5FSCITE8834f78b18f26ea5ac7fad69d0836d6c"></a></span>&nbsp;<span class="scite-citation-text"><a href="https://wiki.nya.pink/index.php?title=Template:SciteAPAJournalResourceFormatter&amp;action=edit&amp;redlink=1" class="new" title="Template:SciteAPAJournalResourceFormatter (page does not exist)">Template:SciteAPAJournalResourceFormatter</a></span></span></li><li id="scite-0d1b702bb5c44f8a054685502e2f75b9"><span class="scite-referencelinks"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#scite-ref-0d1b702bb5c44f8a054685502e2f75b9-2-a" class="scite-backlink" data-citeref-format="number">^</a></span>&nbsp;<span class="scite-citation"><span class="scite-citation-resourcelink"><a href="wiki/Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing-2FReferences-23-5FSCITE0d1b702bb5c44f8a054685502e2f75b9.html" title="Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing-2FReferences-23-5FSCITE0d1b702bb5c44f8a054685502e2f75b9"></a></span>&nbsp;<span class="scite-citation-text"><a href="https://wiki.nya.pink/index.php?title=Template:SciteAPAJournalResourceFormatter&amp;action=edit&amp;redlink=1" class="new" title="Template:SciteAPAJournalResourceFormatter (page does not exist)">Template:SciteAPAJournalResourceFormatter</a></span></span></li><li id="scite-4da4ae5e56b28579e986b1e584171aa3"><span class="scite-referencelinks"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;printable=yes.html#scite-ref-4da4ae5e56b28579e986b1e584171aa3-3-a" class="scite-backlink" data-citeref-format="number">^</a></span>&nbsp;<span class="scite-citation"><span class="scite-citation-resourcelink"><a href="wiki/Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing-2FReferences-23-5FSCITE4da4ae5e56b28579e986b1e584171aa3.html" title="Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing-2FReferences-23-5FSCITE4da4ae5e56b28579e986b1e584171aa3"></a></span>&nbsp;<span class="scite-citation-text"><a href="https://wiki.nya.pink/index.php?title=Template:SciteAPAJournalResourceFormatter&amp;action=edit&amp;redlink=1" class="new" title="Template:SciteAPAJournalResourceFormatter (page does not exist)">Template:SciteAPAJournalResourceFormatter</a></span></span></li></ol></div> <!-- end column -->
<br style="clear: both;"/></div>
</div></div>
		
		<div class="printfooter">Retrieved from "<a dir="ltr" href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;oldid=303.html">https://wiki.nya.pink/index.php?title=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing&amp;oldid=303</a>"</div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="wiki/Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="wiki/Category:Matrix_completion.html" title="Category:Matrix completion">Matrix completion</a></li></ul></div></div>
		<div class="visualClear"></div>
		
	</div>
</div>
<div id='mw-data-after-content'>
	<div class="smw-tabs smw-factbox"><input id="tab-facts-list" class="nav-tab" type="radio" name="tabs" checked=""/><label id="tab-label-facts-list" for="tab-facts-list" class="nav-label" title="Shows statements and facts that have been created by a user">Facts</label><section id="tab-content-facts-list"><div class="mw-parser-output"><div class="smwfact" style="display:block;"><div class="smwfactboxhead">... more about "<span class=""><a href="wiki/Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing.html" title="Special:Browse/:Research:Improving-20Low-2Drank-20Matrix-20Completion-20Algorithms-20Using-20Debiasing-2FHastie-202014-20softImpute-2DALS-20debiasing">Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing</a></span>"</div><div class="smwrdflink"><span class="rdflink"><a href="wiki/Special:ExportRDF/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing" title="Special:ExportRDF/Research:Improving Low-rank Matrix Completion Algorithms Using Debiasing/Hastie 2014 softImpute-ALS debiasing">RDF feed</a></span></div><div class="smw-table smwfacttable"><div class="smw-table-row"><div class="smw-table-cell smwspecname"><span class="smw-highlighter" data-type="1" data-state="inline" data-title="Property" title="This property is a special property in this wiki."><span class="smwbuiltin"><a href="wiki/Property:Citation_reference.html" title="Property:Citation reference">Citation reference</a></span><span class="smwttcontent">This property is a special property in this wiki.</span></span></div><div class="smw-table-cell smwspecs">hastie2014matrix  <span class="smwsearch"><a href="wiki/Special:SearchByProperty/:Citation-20reference/hastie2014matrix.html" title="Special:SearchByProperty/:Citation-20reference/hastie2014matrix">+</a></span>, jain2012lowrank  <span class="smwsearch"><a href="wiki/Special:SearchByProperty/:Citation-20reference/jain2012lowrank.html" title="Special:SearchByProperty/:Citation-20reference/jain2012lowrank">+</a></span>&#160; and&#160;hardt2013understanding  <span class="smwsearch"><a href="wiki/Special:SearchByProperty/:Citation-20reference/hardt2013understanding.html" title="Special:SearchByProperty/:Citation-20reference/hardt2013understanding">+</a></span></div></div></div></div></div></section></div>
</div>


		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="./index.php%3Ftitle=Special:UserLogin&amp;returnto=Research:Improving+Low-rank+Matrix+Completion+Algorithms+Using+Debiasing%252FHastie+2014+softImpute-ALS+debiasing&amp;returntoquery=printable=yes.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="wiki/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://wiki.nya.pink/index.php?title=Talk:Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<ul class="menu">
													</ul>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="wiki/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;action=edit.html" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;action=history.html" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<ul class="menu">
													</ul>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://wiki.nya.pink/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Lab Journal Wiki" title="Search Lab Journal Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="robots.txt.html" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage-description"><a href="robots.txt.html" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="https://wiki.nya.pink/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="wiki/Special:Random.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help-mediawiki"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">Help about MediaWiki</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="wiki/Special:WhatLinksHere/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="https://wiki.nya.pink/wiki/Special:RecentChangesLinked/Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing/Hastie_2014_softImpute-ALS_debiasing" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="wiki/Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;oldid=303.html" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="./index.php%3Ftitle=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;action=info.html" title="More information about this page">Page information</a></li><li id="t-cite"><a href="./index.php%3Ftitle=Special:CiteThisPage&amp;page=Research:Improving_Low-rank_Matrix_Completion_Algorithms_Using_Debiasing%252FHastie_2014_softImpute-ALS_debiasing&amp;id=303.html" title="Information on how to cite this page">Cite this page</a></li><li id="t-smwbrowselink"><a href="wiki/Special:Browse/:Research:Improving-5FLow-2Drank-5FMatrix-5FCompletion-5FAlgorithms-5FUsing-5FDebiasing-2FHastie-5F2014-5FsoftImpute-2DALS-5Fdebiasing.html" rel="search">Browse properties</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 17 August 2020, at 02:48.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="https://wiki.nya.pink/wiki/Lab_Journal_Wiki:Privacy_policy" title="Lab Journal Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="https://wiki.nya.pink/wiki/Lab_Journal_Wiki:About" title="Lab Journal Wiki:About">About Lab Journal Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="https://wiki.nya.pink/wiki/Lab_Journal_Wiki:General_disclaimer" title="Lab Journal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a><a href="https://www.semantic-mediawiki.org/wiki/Semantic_MediaWiki"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAMAAABUFvrSAAACJVBMVEXe3t62trbLy8vGxsbAwMDX19e6urqsrKxHcEzQ0NC2tratra2oqKixsbHd3eDFxcXe3t7U1NTa2trX19fQ0NDV1dWNjY2dnZ2UlJSUlJTS0tKUlJSWlpbR0dGenp79/f38/Pz+/v7t7e3v7+/u7u7s7Oz19fX29vb6+vr7+/vz8/Pz8/P4+fnw8PD39/gWTq/09PX6+vktX7b/sg8XT7F6mc/f5OwhVrNvkMthhsfT2+j7rQ/M1eZqjcmFotPs7e9Cb722xuFResK/zOObstnu7/Grvd3M1+mNqNY6aLoaUbEaUbZWfsTk6fE2Zrnp7O8bTq0kWLQuYcpcg8Xh5/Byk83a4eukud1/nM+6yeQkWcGwwuDxnRQyYrigttvI0+gpW7XGyttLdsBni8geVLo0Z9XlkCPb4u+QqtcfVLLo7PNHcr73phFGX6HsmBnpkxg6bNwnXcbX3er19vnr7/SVrdhuhLl+j70vVqY6Xqv0oxJVcbQhV76DjKTz9ffQ2evE0OZAbbzu7/PS1uFufrDnrGgpSZjy8/SQnMFddrKuekXSiCsgTKRaaZHejy9yang3VptNaqspWbnmliy3j2/m6OzT3e7x8fL4+v3p6uwaN2re0cifqLiLiZWYhYGYb0xXYn+5g0xwiMKYpc2BcHZmW2srRXpGWIhecKfilz4+WID2+PyosMywqbGqss1aVnLZq33p1sGklZqrp7dkfr7CpY9yg59Ud6QZAAAAH3RSTlPfBN/f39/f2wDf39vV3/7N2rrEz5D5c8ONuHaPuXXDImoxqwAABO1JREFUSMe1kQdz01gQgBXaBS4w9OtHwMFSdPKTUNxkW+61xN2Je4tLHJNOGukkAUINJTzaUIbO9fr7TpLtS44DZiC5b6Sn3dW+TysJaWz4cv9eZFPZu/+bhkakYR88WqP59u3vjxzdDCT7GpCD4qNH3sEGzOhB5MCR/4PmA8j25uZ33t0A23lxff5hZTIzOrz2Ph8qK936l7i1tT7hk8DAoHNsbeLWKjPdQcZ+qvX9tHMNXca1XBDXHtL6x2Bh0HWtuXUo8oTgC1gVpcdsdpew92PUYtjwzFq+E9mJYfXxx1x5l2/l5Vhy0DW6TuyQCZcR2hnswXJM0h+203471u5WKMIE5mDpspIIO8sZTMZiIbczY6+JCaI+/sJZ38qjP28+nQjkx/mcqGJ26rW3iKg/fYphCL1jNk5WbqXI0nBnu00RJ2j9bNRp6MmFS0SYIXLuUlQ5w22qizHr5MTyy2u/3XxVvHHlwtWVa/xTCQIIlEaMzrgswzA5P9BrAciYASqNoiNdjL8b0GYAHN3AGAEgzPSQc9UtYCeyBQAMO2G9PhhzXfp9qdifSCT6Lj788QQnrvWEuNPI2um0LW0D+m4A6E4AnIZOeq7ksQuJvi6eUXRW+8EWXsxNPhkYGJiSXr7Rd1qtVp9MXHkgIurzAkdFxjrj7cmKbN4K5v8RGxT2sJMTpwBflNHhUJgBdoUylzy3TuwIDBRi0hf9p9VtbW3qk30X7q2Je1IybZq7mLVWFKTSADXPoqi9AzVorda0kKTS6KkRbSgaR1GT1h5CObYiW1GU27yc5z6F9Fn/yTYedeLi9AIA6AbgxGIxAMPZcZeUHH9cFavVfY97FaNA/DbazRZVV89/61at2BTlg1JXiFtrYoBmRyd7p6/UP0XxaSDmy4pt0jmuh8qx6wQ2MmRz18TaJCUWO9xisUVhMMsoZZDiGHLLuXUbso2iatP/1HvhYu3n3bh6Pe/LUjZSj1NUJ8lSlNwahRRlMRjmyFDICikVn8+SacomdbZTVj+0mQSxweS1WqpiHK/Ncubs858f9idOJ/qKS1cv+RbFuIbMmHEvTbO4QeF25CxyD62nSbmJ1MUzRrpiwR0RPBJMpnCGxWVGXBn8TkarNGQHjuPrxOeWY4GY9FmxWHy19Gvv+ayYF6f8oYi7i8U93bjFkYokvbhWEFu8Og2ZxrUe3NMpc3vLhqqYpVV4XbwDQkpgoVwYKOR9N5d+eXB5vJevQA0pD7oVqi4WOj16vX6EYSA08WKvyeOZJw1cQ6rsnXOa/RYoM0Kls0zLuVoHhHAHL8YFXkwVCoE8uXhvMVCY8mW5Ci8eKkcgJ9azOl0UajNDFiUpj5JeloEqTgwd/iCUJP0sFMSejkpO96b4zl1fPuYiyd6Vs4GBmHSsJoYmLy/WeBTlis5rlJYrgjhe1s+XOXGEtHJOMl4VB2EHLauKdyG7JBLIc//uslRKkhOrcGJqyiU9z5UkOpVOwiGXSyQizRAfqlRc7Y5KJFnV6FReiWSV7xAWeQd/SOSq6qY18eVHq4vjlyazEJ73ScmJPVxJVKdF9MFwYpFIEL+ehvDOcSH8YXRsAa4XfwS7kd0tLfw7Sp7fl7xJywbYjTTVotfTb+849lEcb0K+2lMN/5o+tons+Rxp+PrQ8U3n0BcNSGPj4W+bPuX5ZLNo+uxwY+PfoLJHX1KXgyMAAAAASUVORK5CYII=" alt="Powered by Semantic MediaWiki" class="smw-footer" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"smw":{"limitreport-intext-parsertime":0},"limitreport":{"cputime":"1.359","walltime":"2.235","ppvisitednodes":{"value":769,"limit":1000000},"ppgeneratednodes":{"value":0,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":3,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":1,"limit":20},"unstrip-size":{"value":7053,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201215164716","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":71});});</script>
</body>
</html>
